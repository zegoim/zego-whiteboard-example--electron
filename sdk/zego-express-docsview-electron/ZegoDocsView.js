!function(e,t){for(var o in t)e[o]=t[o]}(exports,function(e){var t={};function o(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=e,o.c=t,o.d=function(e,t,i){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(i,r,function(t){return e[t]}.bind(null,r));return i},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=11)}([,,,function(e,t,o){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this.appid="",this.roomid="",this.userid="",this.token="",this.isTestEnv=!0,this.version="",this.platform="",this.extra={},this.isProd=!1,this.isElectron=!1,this.logLevel=1,this.logCacheSend=[],this.logCacheMax=100,this.platform=e||"",this.isElectron=t,this.openLogServer()}return e.prototype.init=function(e){var t=e.appid,o=e.isTestEnv,i=e.version,r=e.isProd,n=e.liveroom;this.appid=(t||this.appid)+"",this.isTestEnv=o,this.version=i||this.version,this.isProd=r,n&&!this.platform.includes("liveroom")&&(this.platform+=",liveroom")},e.prototype.initRoom=function(e){var t=e.roomid,o=e.userid,i=e.token,r=e.logLevel;this.roomid=t||this.roomid,this.userid=o||this.userid,this.token=i||this.token,"number"==typeof r&&(this.logLevel=r)},e.prototype.setExtraConfig=function(e){Object.assign(this.extra,e)},e.prototype.getConfig=function(){return{appid:+this.appid,roomid:this.roomid,userid:this.userid,token:this.token,isTestEnv:this.isTestEnv}},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var o=this.log(0,e);if(this.logLevel>0);else{var i=console.debug;i(o)}},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var o=this.log(1,e);if(this.logLevel>1);else{var i=console.info;i(o)}},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var o=this.log(2,e);if(this.logLevel>2);else{var i=console.warn;i(o)}},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var o=this.log(3,e);if(this.logLevel>3);else{var i=console.error;i(o)}},e.prototype.writeLocalLog=function(e){},e.prototype.log=function(e,t){var o=this.isProd||this.isElectron?this.logParamList(e,t.join("")):t.join("");return this.isProd&&this.remoteWebSocketLog(e,o),this.isElectron&&this.writeLocalLog(o),o},e.prototype.openLogServer=function(){this.stopWebSocketServer(),this.websocket=new WebSocket("wss://weblogger-edu.zego.im/log")},e.prototype.stopWebSocketServer=function(){this.websocket&&(this.websocket.close(),this.websocket=null)},e.prototype.remoteWebSocketLog=function(e,t){if(!("string"==typeof t&&t.length>4e3))if(null==this.websocket||2==this.websocket.readyState||3==this.websocket.readyState)this.openLogServer(),this.logCacheSend.length<this.logCacheMax&&this.logCacheSend.push(t);else if(0==this.websocket.readyState)this.logCacheSend.length<this.logCacheMax&&this.logCacheSend.push(t);else if(1==this.websocket.readyState)if(this.logCacheSend.length>0){for(var o="",i=0;i<this.logCacheSend.length;i++)(o+this.logCacheSend[i]).length>4e3&&(this.websocket.send(o),o=""),o=o+this.logCacheSend[i]+"\n";t=o+t,this.logCacheSend=[],this.websocket.send(t)}else this.websocket.send(t);else this.logCacheSend.length<this.logCacheMax&&this.logCacheSend.push(t)},e.prototype.logParamList=function(e,t){var o=(new Date).toLocaleString(),r=t.indexOf(" "),n=t.substr(0,r)||t,s=t.substr(r+1,4500),a=i(i({time:o,level:e,action:n,content:s,appid:this.appid,userid:this.userid,roomid:this.roomid},this.extra),{version:this.version,platform:this.platform});return JSON.stringify(a)},e}(),n=function(e,t,o){var i=!(!e||!e.versions.electron);return{electron:i,platform:(i?e.platform:t)+","+o[o.length-2]+","+o[o.length-1]}}(window.process,navigator.platform,navigator.userAgent.split(" ")),s=n.electron,a=n.platform,h=s?"ec.":"web.";t.getLogAction=function(e,t){return""+h+e+t+" "},t.Logger=window.zegoLogger||(window.zegoLogger=new r(a,s))},,function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Docs="zegoeventdocs",e.Whiteboard="zegoeventwb"}(t.DomEvent||(t.DomEvent={})),function(e){e.WbInit="wbinit",e.WbDragTool="wbdragtool",e.WbScale="wbscale",e.WbDestroy="wbdestroy",e.WbError="wberror",e.Snapshot="snapshot",e.Page="page",e.Step="step",e.SyncDrag="syncDrag",e.Animation="targetclick",e.H5Snapshot="getH5SnapshotResult",e.DocsAspect="getAspectCache",e.ReloadView="reloadview"}(t.DomEventAction||(t.DomEventAction={}))},function(e,t,o){"use strict";function i(e){for(var o in e)t.hasOwnProperty(o)||(t[o]=e[o])}Object.defineProperty(t,"__esModule",{value:!0}),i(o(10)),i(o(15)),i(o(5)),t.INTERVAL_PAGE=100,t.SYNC_PPT_TIME=1e3,t.SYNC_PPT_INIT_TIME=2e4,t.PPT_LOAD_TIME=62e3,t.RENDER_MAX_ZOOM=2*(window.devicePixelRatio||1),t.DOMIDS={zoom:"zego-docsview-zoom",doc:"zego-docsview-con",render:"zego-docsview-render",iframe:"zego-docsview-iframe",wb:"zego-whiteboard"},function(e){e[e.PDF=0]="PDF",e[e.PPT=1]="PPT",e[e.H5_PPT=2]="H5_PPT",e[e.H5_CUSTOM=3]="H5_CUSTOM"}(t.RenderMode||(t.RenderMode={})),function(e){e.Error="onError",e.Upload="onUpload",e.LoadFile="onLoadFile",e.StepChange="onStepChange",e.Scroll="onScroll",e.PlayAnimation="onPlayAnimation"}(t.ZegoEventType||(t.ZegoEventType={})),function(e){e.Load="onDocsLoadPdf",e.GetPageImage="onDocsGetPDFPageImage",e.Uploading="onDocsUploading",e.Convert="onDocsConvertStatus",e.Downloading="onDocsDownloading",e.QueryCache="onDocsCachExist",e.CancelCache="onDocsCancelCache",e.DownloadCache="onDocsDownloadCache",e.LoadFile="docsLoad",e.Upload="docsUpload",e.UploadH5File="docsUploadH5File"}(t.DocsListener||(t.DocsListener={})),function(e){e.InitPlatform="initPlatform",e.GetAllPageStepCount="getAllPageStepCount",e.SetCustomizedConfig="setCustomizedConfig",e.GotoPage="gotoPage",e.PreviousStep="previousStep",e.NextStep="nextStep",e.TriggerElementsClick="triggerElementsClick",e.SnapshotForH5="snapshotForH5",e.StopPlay="stopPlay",e.SetVolume="setVolume",e.HideLoadingStyle="hideLoadingStyle"}(t.H5ScriptEvents||(t.H5ScriptEvents={})),function(e){e.Scale="scale",e.SyncDOMEvent="syncDOMEvent",e.PptOperationAuth="pptOperationAuth"}(t.H5ScriptConfig||(t.H5ScriptConfig={}))},function(e,t){!function(){if(-1!==window.navigator.userAgent.indexOf("Trident")){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var o=document.createEvent("CustomEvent");return o.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),o}e.prototype=window.Event.prototype,window.CustomEvent=e,document.body.scrollTo||(Element.prototype.scrollTo=function(e,t){this.scrollLeft=e,this.scrollTop=t}),document.body.scrollBy||(Element.prototype.scrollBy=function(e,t){this.scrollLeft+=e,this.scrollTop+=t}),FileReader.prototype.readAsBinaryString||(FileReader.prototype.readAsBinaryString=function(e){var t=this,o=new FileReader;o.onload=function(e){for(var i="",r=new Uint8Array(o.result),n=r.byteLength,s=0;s<n;s++)i+=String.fromCharCode(r[s]);t.content=i,t.result=i,t.onload()},o.readAsArrayBuffer(e)})}}()},function(e,t,o){"use strict";var i,r=function(){return void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i},n=function(){var e={};return function(t){if(void 0===e[t]){var o=document.querySelector(t);if(window.HTMLIFrameElement&&o instanceof window.HTMLIFrameElement)try{o=o.contentDocument.head}catch(e){o=null}e[t]=o}return e[t]}}(),s=[];function a(e){for(var t=-1,o=0;o<s.length;o++)if(s[o].identifier===e){t=o;break}return t}function h(e,t){for(var o={},i=[],r=0;r<e.length;r++){var n=e[r],h=t.base?n[0]+t.base:n[0],c=o[h]||0,l="".concat(h," ").concat(c);o[h]=c+1;var p=a(l),g={css:n[1],media:n[2],sourceMap:n[3]};-1!==p?(s[p].references++,s[p].updater(g)):s.push({identifier:l,updater:v(g,t),references:1}),i.push(l)}return i}function c(e){var t=document.createElement("style"),i=e.attributes||{};if(void 0===i.nonce){var r=o.nc;r&&(i.nonce=r)}if(Object.keys(i).forEach((function(e){t.setAttribute(e,i[e])})),"function"==typeof e.insert)e.insert(t);else{var s=n(e.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(t)}return t}var l,p=(l=[],function(e,t){return l[e]=t,l.filter(Boolean).join("\n")});function g(e,t,o,i){var r=o?"":i.media?"@media ".concat(i.media," {").concat(i.css,"}"):i.css;if(e.styleSheet)e.styleSheet.cssText=p(t,r);else{var n=document.createTextNode(r),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(n,s[t]):e.appendChild(n)}}function d(e,t,o){var i=o.css,r=o.media,n=o.sourceMap;if(r?e.setAttribute("media",r):e.removeAttribute("media"),n&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(n))))," */")),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}var f=null,u=0;function v(e,t){var o,i,r;if(t.singleton){var n=u++;o=f||(f=c(t)),i=g.bind(null,o,n,!1),r=g.bind(null,o,n,!0)}else o=c(t),i=d.bind(null,o,t),r=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(o)};return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else r()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=r());var o=h(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var i=0;i<o.length;i++){var r=a(o[i]);s[r].references--}for(var n=h(e,t),c=0;c<o.length;c++){var l=a(o[c]);0===s[l].references&&(s[l].updater(),s.splice(l,1))}o=n}}}},function(e,t,o){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var o=function(e,t){var o=e[1]||"",i=e[3];if(!i)return o;if(t&&"function"==typeof btoa){var r=(s=i,a=btoa(unescape(encodeURIComponent(JSON.stringify(s)))),h="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(h," */")),n=i.sources.map((function(e){return"/*# sourceURL=".concat(i.sourceRoot||"").concat(e," */")}));return[o].concat(n).concat([r]).join("\n")}var s,a,h;return[o].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(o,"}"):o})).join("")},t.i=function(e,o,i){"string"==typeof e&&(e=[[null,e,""]]);var r={};if(i)for(var n=0;n<this.length;n++){var s=this[n][0];null!=s&&(r[s]=!0)}for(var a=0;a<e.length;a++){var h=[].concat(e[a]);i&&r[h[0]]||(o&&(h[2]?h[2]="".concat(o," and ").concat(h[2]):h[2]=o),t.push(h))}},t}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.UnloadVideoSrc="unloadVideoSrc",e.DisableH5ImageDrag="disableH5ImageDrag",e.PptStepMode="pptStepMode",e.ThumbnailMode="thumbnailMode",e.Domain="domain"}(t.ZegoConfigKey||(t.ZegoConfigKey={})),function(e){e[e.ZegoDocsViewSuccess=0]="ZegoDocsViewSuccess",e[e.ZegoDocsViewErrorInternal=2000001]="ZegoDocsViewErrorInternal",e[e.ZegoDocsViewErrorParamInvalid=2000002]="ZegoDocsViewErrorParamInvalid",e[e.ZegoDocsViewErrorNetworkTimeout=2000003]="ZegoDocsViewErrorNetworkTimeout",e[e.ZegoDocsViewErrorFileNotExist=2010001]="ZegoDocsViewErrorFileNotExist",e[e.ZegoDocsViewErrorUploadFailed=2010002]="ZegoDocsViewErrorUploadFailed",e[e.ZegoDocsViewErrorUnsupportRenderType=2010003]="ZegoDocsViewErrorUnsupportRenderType",e[e.ZegoDocsViewErrorFileEncrypt=2020001]="ZegoDocsViewErrorFileEncrypt",e[e.ZegoDocsViewErrorFileSizeLimit=2020002]="ZegoDocsViewErrorFileSizeLimit",e[e.ZegoDocsViewErrorFileSheetLimit=2020003]="ZegoDocsViewErrorFileSheetLimit",e[e.ZegoDocsViewErrorConvertFail=2020004]="ZegoDocsViewErrorConvertFail",e[e.ZegoDocsViewErrorConvertCancel=2020005]="ZegoDocsViewErrorConvertCancel",e[e.ZegoDocsViewErrorFileContentEmpty=2020006]="ZegoDocsViewErrorFileContentEmpty",e[e.ZegoDocsViewErrorFileReadOnly=2020007]="ZegoDocsViewErrorFileReadOnly",e[e.ZegoDocsViewErrorConvertElementNotSupported=2020008]="ZegoDocsViewErrorConvertElementNotSupported",e[e.ZegoDocsViewErrorConvertFileTypeInvalid=2020009]="ZegoDocsViewErrorConvertFileTypeInvalid",e[e.ZegoDocsViewErrorAuthParamInvalid=2030001]="ZegoDocsViewErrorAuthParamInvalid",e[e.ZegoDocsViewErrorFilePathNotAccess=2030002]="ZegoDocsViewErrorFilePathNotAccess",e[e.ZegoDocsViewErrorInitFailed=2030003]="ZegoDocsViewErrorInitFailed",e[e.ZegoDocsViewErrorSizeInvalid=2030004]="ZegoDocsViewErrorSizeInvalid",e[e.ZegoDocsViewErrorFreeSpaceLimit=2030005]="ZegoDocsViewErrorFreeSpaceLimit",e[e.ZegoDocsViewErrorUploadNotSupported=2030006]="ZegoDocsViewErrorUploadNotSupported",e[e.ZegoDocsViewErrorUploadDuplicated=2030007]="ZegoDocsViewErrorUploadDuplicated",e[e.ZegoDocsViewErrorEmptyDomain=2030008]="ZegoDocsViewErrorEmptyDomain",e[e.ZegoDocsViewErrorHaveInit=2030009]="ZegoDocsViewErrorHaveInit",e[e.ZegoDocsViewErrorServerFileNotExist=2030010]="ZegoDocsViewErrorServerFileNotExist",e[e.ZegoDocsViewErrorCacheNotSupported=2030014]="ZegoDocsViewErrorCacheNotSupported",e[e.ZegoDocsViewErrorCacheFailed=2030015]="ZegoDocsViewErrorCacheFailed",e[e.ZegoDocsViewErrorZipFileInvalid=2030016]="ZegoDocsViewErrorZipFileInvalid",e[e.ZegoDocsViewErrorH5FileInvalid=2030017]="ZegoDocsViewErrorH5FileInvalid",e[e.ZegoDocsViewErrorFileExtensionNotExist=2020010]="ZegoDocsViewErrorFileExtensionNotExist"}(t.ZegoDocsViewError||(t.ZegoDocsViewError={})),function(e){e[e.ZegoDocsViewFileTypeUnknown=0]="ZegoDocsViewFileTypeUnknown",e[e.ZegoDocsViewFileTypePPT=1]="ZegoDocsViewFileTypePPT",e[e.ZegoDocsViewFileTypeDOC=2]="ZegoDocsViewFileTypeDOC",e[e.ZegoDocsViewFileTypeELS=4]="ZegoDocsViewFileTypeELS",e[e.ZegoDocsViewFileTypePDF=8]="ZegoDocsViewFileTypePDF",e[e.ZegoDocsViewFileTypeIMG=16]="ZegoDocsViewFileTypeIMG",e[e.ZegoDocsViewFileTypeTXT=32]="ZegoDocsViewFileTypeTXT",e[e.ZegoDocsViewFileTypeDynamicPPTH5=512]="ZegoDocsViewFileTypeDynamicPPTH5",e[e.ZegoDocsViewFileTypeAudio=1024]="ZegoDocsViewFileTypeAudio",e[e.ZegoDocsViewFileTypeVideo=2048]="ZegoDocsViewFileTypeVideo",e[e.ZegoDocsViewFileTypeCustomH5=4096]="ZegoDocsViewFileTypeCustomH5"}(t.ZegoDocsViewFileType||(t.ZegoDocsViewFileType={})),function(e){e[e.ZegoDocsViewRenderTypeVector=1]="ZegoDocsViewRenderTypeVector",e[e.ZegoDocsViewRenderTypeIMG=2]="ZegoDocsViewRenderTypeIMG",e[e.ZegoDocsViewRenderTypeVectorAndIMG=3]="ZegoDocsViewRenderTypeVectorAndIMG",e[e.ZegoDocsViewRenderTypeDynamicPPTH5=6]="ZegoDocsViewRenderTypeDynamicPPTH5"}(t.ZegoDocsViewRenderType||(t.ZegoDocsViewRenderType={})),function(e){e[e.UPLOADING=1]="UPLOADING",e[e.UPLOADED=2]="UPLOADED",e[e.WAITING=4]="WAITING",e[e.CONVERTING=8]="CONVERTING",e[e.CONVERTED=16]="CONVERTED",e[e.CONVERT_FAIL=32]="CONVERT_FAIL",e[e.CONVERT_CANCEL=64]="CONVERT_CANCEL"}(t.ZegoDocsViewUploadState||(t.ZegoDocsViewUploadState={}))},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(12),r=function(){function e(e,t){this.serviceHandle=new i.ZegoDocsViewService(e,t)}return e.prototype.createView=function(e,t,o){return this.serviceHandle.createView(e,t,o)},e.prototype.uploadFile=function(e,t,o,i){return this.serviceHandle.uploadFile(e,t,o,i)},e.prototype.cancelUploadFile=function(e){return this.serviceHandle.cancelUploadFile(e)},e.prototype.uploadH5File=function(e,t,o){return this.serviceHandle.uploadH5File(e,t,o)},e.prototype.cacheFile=function(e,t){return this.serviceHandle.cacheFile(e,t)},e.prototype.cancelCacheFile=function(e){return this.serviceHandle.cancelCacheFile(e)},e.prototype.queryFileCached=function(e){return this.serviceHandle.queryFileCached(e)},e.prototype.on=function(e,t){return this.serviceHandle.addEventListener(e,t)},e.prototype.off=function(e,t){return this.serviceHandle.removeEventListener(e,t)},e.prototype.getVersion=function(){return this.serviceHandle.getVersion()},e.prototype.setTestEnv=function(e){this.serviceHandle.setTestEnv(e)},e.prototype.setConfig=function(e,t){return this.serviceHandle.setConfig(e,t)},e.prototype.getConfig=function(e){return this.serviceHandle.getConfig(e)},e}();t.ZegoExpressDocs=r},function(e,t,o){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=o(13),a=o(16),h=o(3),c=o(19),l=o(6),p=h.getLogAction.bind(null,"docs.s."),g=function(e){function t(t,o){var i,r=e.call(this)||this;return r.docsviews={},r.listeners=((i={})[l.DocsListener.Load]={},i[l.DocsListener.GetPageImage]={},i[l.DocsListener.LoadFile]={},i[l.DocsListener.DownloadCache]={},i[l.DocsListener.CancelCache]={},i[l.DocsListener.QueryCache]={},i[l.DocsListener.Upload]={},i[l.DocsListener.UploadH5File]={},i),r.seqMap={load:""},r.errorStatusList=[32,64,128,256,512,1024,2048,4096,8192,16384,32768,32769],r.zegoDocs=o,r.isElectron=!0,r.init(t),r.registerEvent(),r}return r(t,e),t.prototype.setTestEnv=function(e){this.zegoDocs.zego_docs_set_test_env(e),h.Logger.info(p("setTestEnv"),JSON.stringify({params:e}))},t.prototype.setConfig=function(e,t){var o,i;return["set_alpha_env","dynamicPPT_HD",l.ZegoConfigKey.Domain,l.ZegoConfigKey.ThumbnailMode].includes(e)?(t="boolean"==typeof t?t?"true":"false":t,i=this.zegoDocs.zego_docs_set_custom_config(e,t)):i=this.setStore(((o={})[e]=t,o)),h.Logger.info(p("setConfig"),JSON.stringify({params:{key:e,value:t},result:i})),i},t.prototype.getConfig=function(e){var t;return e===l.ZegoConfigKey.Domain||e===l.ZegoConfigKey.ThumbnailMode?"true"==(t=this.zegoDocs.zego_docs_get_custom_config(e))?t=!0:"false"==t&&(t=!1):t=this.getStore()[e],h.Logger.info(p("getConfig"),JSON.stringify({params:e,result:t})),t},t.prototype.uploadFile=function(e,t,o,i){var r=this;return new Promise((function(n,s){var a=r.zegoDocs.zego_docs_upload(e,"",t);r.listeners[l.DocsListener.Upload][a]=function(e){var t=e.seq,a=e.status,h=e.code;a==l.ZegoDocsViewUploadState.CONVERTED?(delete r.listeners[l.DocsListener.Upload][t],n(e.fileID)):h||r.errorStatusList.includes(a)?(delete r.listeners[l.DocsListener.Upload][t],s(l.transError(h||a))):(o&&Object.assign(e,o),i&&"function"==typeof i?i(e):r.triggerEventListener(l.ZegoEventType.Upload,e))},h.Logger.info(p("uploadFile"),JSON.stringify({file:e,renderType:t,seq:a}))}))},t.prototype.cancelUploadFile=function(e){var t=this;return new Promise((function(o){t.zegoDocs.zego_docs_cancel_upload(e),o(!0)}))},t.prototype.uploadH5File=function(e,t,o){var i=this;return!(e&&t&&c.isPositiveNumber(t.width)&&c.isPositiveNumber(t.height)&&c.isPositiveNumber(t.pageCount))||t.thumbnailList&&t.thumbnailList.length&&t.thumbnailList.length!==t.pageCount?Promise.reject(l.transError(l.ZegoDocsViewError.ZegoDocsViewErrorParamInvalid)):new Promise((function(r,s){var a=i.zegoDocs.zego_docs_upload_h5_file(e,t.width,t.height,t.pageCount,t.thumbnailList||[]);i.listeners[l.DocsListener.UploadH5File][a]=function(e){var t=e.seq,a=e.status,h=e.code;a===l.ZegoDocsViewUploadState.CONVERTED?(delete i.listeners[l.DocsListener.UploadH5File][t],r(e.fileID)):h||i.errorStatusList.includes(a)?(delete i.listeners[l.DocsListener.UploadH5File][t],s(n(n({},l.transError(h||a)),{data:e}))):o&&o(e)},h.Logger.info(p("uploadH5File"),JSON.stringify({params:t,file:e,result:a}))}))},t.prototype.cacheFile=function(e,t){var o=this;return new Promise((function(i,r){var n=o.zegoDocs.zego_docs_download_cache(e,"");o.listeners[l.DocsListener.DownloadCache][n]=function(e){"number"==typeof e.rate?t({seq:e.seq,cachePercent:Math.round(100*e.rate)}):(delete o.listeners[l.DocsListener.DownloadCache][e.seq],0===e.error_code?i(e.seq):r(l.transError(e.error_code)))}}))},t.prototype.cancelCacheFile=function(e){var t=this;return new Promise((function(o,i){t.zegoDocs.zego_docs_cancel_download_cache(e),t.listeners[l.DocsListener.CancelCache][e]=function(e){delete t.listeners[l.DocsListener.CancelCache][e.seq],0===e.error_code?o(!0):i(l.transError(e.error_code))}}))},t.prototype.queryFileCached=function(e){var t=this;return new Promise((function(o,i){var r=t.zegoDocs.zego_docs_cache_exist(e,"");t.listeners[l.DocsListener.QueryCache][r]=function(e){0===e.error_code?o(!!e.exist):i(l.transError(e.error_code))}}))},t.prototype.getVersion=function(){return"2.1.5"},t.prototype.createView=function(e,t,o){var i={parent:e,viewID:t=(t||Date.now()+Math.floor(1e3*Math.random()))+"",sheetName:o=o||""},r=p("createView"),n=this.docsviews[t];if(n)return n.setSheetName(o),h.Logger.info(r,JSON.stringify({actionMsg:"find in cache",params:i})),n;var a=document.getElementById(l.DOMIDS.wb+t);if(a=a&&a.parentElement){var c=a.id.replace(l.DOMIDS.doc,"");if(n=this.docsviews[c])return n.setSheetName(o),this.docsviews[t]=n,i.wbID=c,h.Logger.info(r,JSON.stringify({actionMsg:"find in cache on whiteboard",params:i})),n}return(n=new s.ZegoDocsViewImpl(this,e,t)).setSheetName(o),this.docsviews[t]=n,h.Logger.info(r,JSON.stringify({params:i})),n},t.prototype.execViewFuction=function(e,t,o){if("unloadFile"!==e){var i=this.docsviews[t];i&&i[e].apply(i,o)}else delete this.docsviews[t]},t.prototype.registerEventHandler=function(e,t,o){this.listeners[t][e]=o},t.prototype.load=function(e,t,o){var i=this;return new Promise((function(r,s){i.seqMap.load=e,i.listeners[l.DocsListener.LoadFile][e]=i.listeners[l.DocsListener.LoadFile][e]||{config:t,render:o,listener:function(t){var o=i.listeners[l.DocsListener.LoadFile][e];if(0===t.error_code&&t.file_list&&t.file_list.length)h.Logger.info(p("loadFile"),JSON.stringify({id:e,params:o.config,result:t})),i.transLoadFile(t),setTimeout((function(){return i.listeners[l.DocsListener.Load][e](t)})),r(t);else if(o.config){var a=o.config,c=a.fileID,g=a.authKey;i.zegoDocs.zego_docs_load(c,g,c),delete o.config}else i.triggerEventListener(l.ZegoEventType.Error,t),s(n(n({},l.transError(t.error_code)),{data:t}))}};var a=t.fileID,c=t.authKey;i.zegoDocs.zego_docs_load(a,c,a)}))},t.prototype.getPageImage=function(e,t){this.seqMap.load=e;var o=t.virtual_page_number,i=t.rate,r=t.res;if(r.file_type===l.ZegoDocsViewFileType.ZegoDocsViewFileTypeDynamicPPTH5||r.file_type===l.ZegoDocsViewFileType.ZegoDocsViewFileTypeCustomH5){var n=this.listeners[l.DocsListener.GetPageImage][e];n&&n(this.transPPTH5(t))}else this.zegoDocs.zego_docs_get_page_image(r.file_id,o,Math.max(i||1,1),0,"")},t.prototype.decryptImage=function(e){return Promise.resolve("")},t.prototype.init=function(e){this.setTestEnv(!!e.isTestEnv),this.zegoDocs.zego_docs_set_cache_directory(e.cacheFolder),this.zegoDocs.zego_docs_set_log_folder(e.logFolder||e.dataFolder||e.cacheFolder,3),this.zegoDocs.zego_docs_init(e.appID,e.appSign,e.dataFolder),h.Logger.writeLocalLog=this.writeLocalLog,h.Logger.init({isTestEnv:e.isTestEnv,appid:e.appID,version:this.getVersion(),isProd:!0}),h.Logger.info(p("new"),JSON.stringify({params:e}))},t.prototype.writeLocalLog=function(){},t.prototype.registerEvent=function(){var e=this;this.zegoDocs.registerEventHandler(l.DocsListener.Load,(function(t){var o,i=null===(o=e.listeners[l.DocsListener.LoadFile][e.seqMap.load])||void 0===o?void 0:o.listener;i&&i(t)})),this.zegoDocs.registerEventHandler(l.DocsListener.GetPageImage,(function(t){if(1===t.status&&1===t.source&&t.image_path||t.image_data){var o=e.listeners[l.DocsListener.GetPageImage][e.seqMap.load];o&&o(t)}})),this.zegoDocs.registerEventHandler(l.DocsListener.Uploading,(function(t){h.Logger.info(p("upload_ing"),JSON.stringify({result:t}));var o={seq:t.seq,code:t.error_code,status:l.ZegoDocsViewUploadState.UPLOADING};"number"==typeof t.rate&&(o.uploadPercent=Math.round(100*t.rate)),0!==o.code&&(o.status=l.ZegoDocsViewUploadState.CONVERT_FAIL),t.file_id&&(o.status=l.ZegoDocsViewUploadState.CONVERTED,o.fileID=t.file_id);var i=e.listeners[l.DocsListener.UploadH5File][t.seq];if(i)i(o);else{var r=e.listeners[l.DocsListener.Upload][t.seq];r&&r(o)}})),this.zegoDocs.registerEventHandler(l.DocsListener.Convert,(function(t){h.Logger.info(p("upload_cv"),JSON.stringify({result:t}));var o={seq:t.seq,code:t.error_code,status:t.convert_status};t.file_id&&(o.fileID=t.file_id);var i=e.listeners[l.DocsListener.UploadH5File][t.seq];if(i)i(o);else{var r=e.listeners[l.DocsListener.Upload][t.seq];r&&r(o)}})),[l.DocsListener.Downloading,l.DocsListener.DownloadCache,l.DocsListener.CancelCache,l.DocsListener.QueryCache].forEach((function(t){e.zegoDocs.registerEventHandler(t,(function(o){h.Logger.info(p(t),JSON.stringify({result:o})),t===l.DocsListener.Downloading&&(t=l.DocsListener.DownloadCache);var i=e.listeners[t][o.seq];i&&i(o)}))}))},t.prototype.transPPTH5=function(e){var t=e.res,o=e.virtual_page_number;return{error_code:0,file_id:t.file_id,image_data:t.file_list[0].file_url,image_path:"",virtual_page_number:o}},t.prototype.transLoadFile=function(e){e.file_id=e.user_data,delete e.user_data;var t=e.document_type;if(e.file_type=t,delete e.document_type,e.file_list&&e.file_list.length){var o=e.file_list[0];e.page_count||(e.page_count=o.page_list.length);var i=o.page_list[0],r=i.width,n=i.height;e.width=r,e.height=n,e.cdn_hosts=[];var s=[],a=[];if(o.page_list.forEach((function(e){s.push(e.thumb_data||""),a.push(e.page_data||""),delete e.thumb_data,delete e.page_data})),e.thumbnails=s,e.notes=a,(t===l.ZegoDocsViewFileType.ZegoDocsViewFileTypeDynamicPPTH5||t===l.ZegoDocsViewFileType.ZegoDocsViewFileTypeCustomH5)&&o.file_url){var h=o.file_url.split(";");e.cdn_hosts=h.map((function(e){return/https?:\/\//.test(e)?e.substr(0,e.indexOf(".zego.im")+8):""})),o.file_url=h[0],o.page_count=e.page_count,o.page_list=[{width:r,height:n,virtual_page_list:[{width:r,height:n,virtual_page_number:1}]}]}t===l.ZegoDocsViewFileType.ZegoDocsViewFileTypeELS?e.file_list.forEach((function(t){t.name=e.file_name})):o.file_name=e.file_name}},t}(a.ZegoDocsViewServiceBase);t.ZegoDocsViewService=g},function(e,t,o){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},r=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var i=Array(e),r=0;for(t=0;t<o;t++)for(var n=arguments[t],s=0,a=n.length;s<a;s++,r++)i[r]=n[s];return i};Object.defineProperty(t,"__esModule",{value:!0});var n=o(14),s=o(6),a=o(3),h=a.getLogAction.bind(null,"docs.v."),c=function(){function e(e,t,o){var i=this;this.parent="",this.id="",this.wbId="",this.canvasArray=[],this.renderMode=s.RenderMode.PDF,this.isTouch="ontouchstart"in window||navigator.maxTouchPoints>0,this.viewInfo={ticking:!1,percent:0,total:1,sheet:0,sheetName:"",parentWidth:0,parentHeight:0,width:0,height:0,viewWidth:0,viewHeight:0,rate:1,canvasMaxPage:5,scrollTop:0,scrollLeft:0,lastTime:0,lastTimeId:0,scrollTimeId:0,isParentScale:!1,fillPPT:!1,h5CDNUsedMap:{},imgInfo:{isSmall:!1,isScale:!1,width:0,height:0,min_w:640,min_h:400},firstInfo:{page:0,step:0,h5Extra:"",scrollTop:0},maxSteps:{}},this.zoomInfo={zoom:1,x:0,y:0,tx:0,ty:0,isDrag:!1,enableScroll:!0,remoteScroll:!0,dragRectTop:0,dragRectBottom:0},this.ppth5Info={page:1,step:1,scene:0,targetPage:0,targetStep:0,lastStep:-1,goPage:0,goStep:0,notify:!0,loaded:!1,scale:1,goTimer:0,syncTimer:0,pageChangeTimer:0,p:"",loadRetryTimer:0},this.fileInfo={},this.vpageImgCache={},this.vpageAspecCache={},this.vpageDrawImgCache={},this.domEventListeners=null,this.loadFileCallback=function(){var e=i.getLoadFileModelForCallback();i.loadFileListener&&"function"==typeof i.loadFileListener?i.loadFileListener(e):i.serviceHandle.triggerEventListener(s.ZegoEventType.LoadFile,e),a.Logger.info(h("loadFileCallback"))},this.reloadViewCallback=function(){var e={action:s.DomEventAction.ReloadView,data:i.getLoadFileModelForCallback()};if(i.docDom.dispatchEvent(new CustomEvent(s.DomEvent.Docs,{detail:e})),i.renderMode===s.RenderMode.PDF){var t=i.zoomInfo.zoom;i.getDocViewChild().style.cssText+="transform:scale("+t+");";var o=i.viewInfo.scrollLeft*t|0,r=i.viewInfo.scrollTop*t|0;i.docDom.scrollTo(o,r),i.renderDom.scrollTo(o,r),clearTimeout(i.viewInfo.scrollTimeId),i.viewInfo.scrollTimeId=window.setTimeout((function(){i.viewInfo.ticking=!1}),34)}else i.setDocsViewDomTransform(i.zoomInfo.tx,i.zoomInfo.ty);a.Logger.info(h("reloadViewCallback"))},this.handleWhiteboardEvent=function(e){var t=e&&e.detail,o=t.action;if(a.Logger.info(h(s.DomEvent.Whiteboard),JSON.stringify(t)),o===s.DomEventAction.Page)i.handleWhiteboardPageEvent(t);else if(o===s.DomEventAction.WbScale){var r=t,n=r.scale,c=r.x,l=r.y,p=r.notify;i.handleSetScaleFactor(n,c,l,p)}else o===s.DomEventAction.WbDragTool?i.handleWhiteboardDragToolEvent(t):o===s.DomEventAction.WbInit?(a.Logger.setExtraConfig({wbId:t.data}),i.handleWhiteboardInitEvent(t)):o===s.DomEventAction.Animation?i.handleWhiteboardAnimationEvent(t):o===s.DomEventAction.WbDestroy?i.unloadFile():o===s.DomEventAction.Snapshot?i.docsSnapshot(t):o===s.DomEventAction.ReloadView&&i.reloadView()},this.handleIframeMessage=function(e){var t=e.data;if(t&&"zegodocsview"===t.source){var o=t.action,r=t.res,n=t.hash;if(!n||n==="#"+i.id)if("syncDOMEvent"!==o&&"getH5SnapshotResult"!==o&&a.Logger.info(h("h5_iframe"),JSON.stringify(t)),"syncCurrentPage"===o)i.syncCurrentPage(r);else if("syncCurrentStep"===o&&i.ppth5Info.loaded)i.syncCurrentStep(r);else if("syncCurrentPageStep"===o)i.syncCurrentPageStep(r);else if("syncCurrentElement"===o)i.syncCurrentElement(r);else if("syncDOMEvent"===o&&i.domEventListeners){var s=i.domEventListeners[r.type];s&&s(r)}else"syncCurrentError"===o?i.syncCurrentError(r):"onload"===o?i.initIframe():"didLoadFinish"===o?i.ppth5Info.loadRetryTimer&&clearTimeout(i.ppth5Info.loadRetryTimer):"getAllPageStepCount"===o?i.viewInfo.maxSteps=Object.freeze(JSON.parse(r)):"getH5SnapshotResult"===o&&i.getH5SnapshotResult(r)}},this.handleScrollEvent=function(e){i.zoomInfo.enableScroll&&!i.viewInfo.ticking&&(requestAnimationFrame((function(){i.ppth5Info.notify=!0;var t=i.zoomInfo,o=t.zoom,r=t.dragRectTop,n=t.dragRectBottom,s=e.target,a=Math.ceil(s.scrollTop),h=Math.ceil(s.scrollLeft),c=Math.ceil(a/o),l=Math.ceil(h/o),p=Math.ceil(a-i.viewInfo.percent*i.viewInfo.height*o);l!==i.viewInfo.scrollLeft?(i.viewInfo.scrollLeft=l,i.renderDom.scrollLeft=h,i.postSyncDragMessage(h,p)):c!==i.viewInfo.scrollTop&&(i.renderDom.scrollTop=a,1==o||a<r||a>n?(i.updateCurViewMax(a,o),i.onScrollCallback(h,a)):i.postSyncDragMessage(h,p),i.viewInfo.scrollTop=c),i.viewInfo.ticking=!1})),i.viewInfo.ticking=!0)},this.handleDragStart=function(e){i.zoomInfo.x=i.zoomInfo.y=0;var t=i.zoomInfo,o=t.isDrag,r=t.enableScroll,n=t.zoom;if(o){if(!r&&1===n)return;var a=e instanceof MouseEvent?e:e.changedTouches[0],h=a.clientX,c=a.clientY;if(i.renderMode===s.RenderMode.PDF){var l=i.docDom.getBoundingClientRect(),p=l.bottom;if(h>l.right-15||c>p-15)return;i.zoomInfo.tx=i.docDom.scrollLeft,i.zoomInfo.ty=i.docDom.scrollTop}(n>1||i.viewInfo.height>i.viewInfo.viewHeight)&&(i.zoomInfo.x=h,i.zoomInfo.y=c)}},this.handleDragMove=function(e,t){if(i.zoomInfo.isDrag&&i.zoomInfo.x){if(e instanceof MouseEvent&&!t&&e.buttons<1)return;"touchmove"===e.type&&e.preventDefault(),i.ppth5Info.notify=!0,i.renderMode===s.RenderMode.PDF?i.dragPDF(e,!!t):i.dragPPT(e,!!t)}},this.handleDragEnd=function(e){i.handleDragMove(e,!0)},this.serviceHandle=e,this.init(t,o)}return e.prototype.setParentWidthHeight=function(e){var t=document.getElementById(e);t.style.cssText+="position:relative;display:inherit!important;";var o=t.clientWidth,i=t.clientHeight;if(o<=0||i<=0)throw this.serviceHandle.triggerEventListener(s.ZegoEventType.Error,s.transError(s.ZegoDocsViewError.ZegoDocsViewErrorSizeInvalid)),new Error("无法获取容器宽高");this.viewInfo.parentWidth=o,this.viewInfo.parentHeight=i},e.prototype.setDocsViewDomOverflow=function(){var e=this.zoomInfo,t=e.zoom,o=e.enableScroll;if(t>1){var i=this.renderMode===s.RenderMode.PDF&&o?"auto":"hidden";this.docDom.style.overflowX=i,this.docDom.style.overflowY=i,this.renderDom&&(this.renderDom.style.overflowX=i,this.renderDom.style.overflowY=i)}else{var r=this.viewInfo,n=r.height,a=r.viewHeight;i=this.renderMode===s.RenderMode.PDF&&o&&n>a?" auto":"hidden";this.docDom.style.overflowX="hidden",this.docDom.style.overflowY=i,this.renderDom&&(this.renderDom.style.overflowX="hidden",this.renderDom.style.overflowY=i)}},e.prototype.setDocsViewDomTransform=function(e,t){var o=function(e,t,o){return"transform:translate("+e+"px,"+t+"px) scale("+o+");"},i=this.zoomInfo.zoom,r=t-(this.ppth5Info.page-1)*this.viewInfo.viewHeight*i,n=this.renderDom.firstChild;n.style.cssText+=o(e,t,i),(n=this.getDocViewChild()).style.cssText+=o(e,r,i)},e.prototype.getCanvasSplit=function(e){var t=this.viewInfo,o=t.canvasMaxPage,i=t.total,r=(e-1)/o|0;return{index:r,start:r*o+1,end:Math.min(r*o+o,i)}},e.prototype.getCanvasHeight=function(e){var t=this.viewInfo,o=t.sheet,i=t.total,r=t.height,n=t.viewHeight,a=t.canvasMaxPage,h=this.vpageAspecCache[o],c=h.h[e]||0;if(c)return c;if(this.getFileType()===s.ZegoDocsViewFileType.ZegoDocsViewFileTypeIMG)return c=r,h.h[e]=c,c;if(this.renderMode===s.RenderMode.PPT)return c=n,h.h[e]=c,c;for(var l=e?h.p[e*a]+1:h.vs,p=h.p[Math.min((e+1)*a,i)],g=l;g<=p;g++)c+=h[g].h;return c=Math.round(c),h.h[e]=c,c},e.prototype.getImgErrorAspec=function(e,t,o){var i=128*s.RENDER_MAX_ZOOM;return[(e-i)/2,o+=(t-i)/2,i,i]},e.prototype.clearImgError=function(e,t,o,i){e.clearRect.apply(e,this.getImgErrorAspec(t,o,i))},e.prototype.drawImgError=function(e,t,o,i,s){e.drawImage.apply(e,r([n.IMG_ERROR],this.getImgErrorAspec(t,o,i))),a.Logger.info(h("draw_error"),JSON.stringify({p:this.ppth5Info.page,vpage:s}))},e.prototype.drawDividingLine=function(e,t,o,i,r,n,a){e.lineWidth=s.RENDER_MAX_ZOOM,e.beginPath(),a?(e.moveTo(o,0),e.lineTo(o,n)):(e.moveTo(0,i),e.lineTo(r,i)),e.stroke()},e.prototype.getCurrentCDNHost=function(e){return/^https?:\/\//.test(e)&&e.indexOf(".zego.im")>0?e.substr(0,e.indexOf(".zego.im")+8):""},e.prototype.changeDecryptImageCDNHost=function(e,t,o,i){var r=this,n=this.getCurrentCDNHost(o),s=this.getCDNHostList();if(n&&s.length){t[n]=1;var c=(s.findIndex((function(e){return e===n}))+1)%s.length;if(!t[s[c]]){var l=o.replace(n,s[c]);return this.serviceHandle.decryptImage(l).then((function(t){return e.src=t})).catch((function(){return r.changeDecryptImageCDNHost(e,t,l,i)})),void a.Logger.info(h("draw_img_cdn"),JSON.stringify({src:l,action:"DecryptImage"}))}}var p={src:o,action:"DecryptImageLoadError",usedMap:t};this.postErrorMessage(p),a.Logger.info(h("draw_img_error"),JSON.stringify(p)),i()},e.prototype.changeImageCDNHost=function(e,t,o,i){var r=this.getCurrentCDNHost(e.src),n=this.getCDNHostList();if(r&&n.length){t[r]=1;var c=(n.findIndex((function(e){return e===r}))+1)%n.length;if(!t[n[c]])return e.src=e.src.replace(r,n[c])+(i?"?p="+i:""),a.Logger.info(h("draw_"+o+"_cdn"),JSON.stringify({src:e.src,page:i})),!0}var l={src:e.src,page:i,action:"ImageLoadError",code:s.ZegoDocsViewError.ZegoDocsViewErrorNetworkTimeout};return this.postErrorMessage(l),a.Logger.warn(h("draw_"+o+"_error"),JSON.stringify(l)),!1},e.prototype.changeH5CDNHost=function(){var e=this,t=this.viewInfo.h5CDNUsedMap,o=this.iframeDom.src,i=this.getCurrentCDNHost(o),r=this.getCDNHostList();if(i&&r.length){t[i]=(t[i]||0)+1;var n=(r.findIndex((function(e){return e===i}))+1)%r.length,c=r[n];if(n>0&&!t[c])return this.iframeDom.src=o.replace(i,c),this.ppth5Info.loadRetryTimer&&clearTimeout(this.ppth5Info.loadRetryTimer),this.ppth5Info.loadRetryTimer=window.setTimeout((function(){return e.changeH5CDNHost()}),s.PPT_LOAD_TIME),void a.Logger.info(h("draw_h5_cdn"),JSON.stringify({src:this.iframeDom.src}));if(0==n&&1==t[c]){for(var l=1;l<r.length;l++)t[r[l]]=0;if(1==r.length){this.renderDom.removeChild(this.iframeDom);var p=this.vpageAspecCache[0][1],g=p.w,d=p.h;this.createIFrame(s.DOMIDS.iframe+this.id,g,d),this.iframeDom.src=o,this.renderDom.appendChild(this.iframeDom)}else this.iframeDom.src=o.replace(i,c);return this.ppth5Info.loadRetryTimer&&clearTimeout(this.ppth5Info.loadRetryTimer),this.ppth5Info.loadRetryTimer=window.setTimeout((function(){return e.changeH5CDNHost()}),s.PPT_LOAD_TIME),void a.Logger.info(h("draw_h5_cdn_retry"),JSON.stringify({src:this.iframeDom.src}))}}this.ppth5Info.loadRetryTimer&&clearTimeout(this.ppth5Info.loadRetryTimer);var f={src:o,action:"H5LoadError",code:s.ZegoDocsViewError.ZegoDocsViewErrorNetworkTimeout};this.postErrorMessage(f),a.Logger.warn(h("draw_h5_error"),JSON.stringify(f))},e.prototype.drawPPT=function(e,t,o,i,r){var n=this;return new Promise((function(c,l){t*=s.RENDER_MAX_ZOOM,o*=s.RENDER_MAX_ZOOM;var p={},g=r.getContext("2d"),d=new Image;d.setAttribute("crossOrigin","anonymous"),d.onload=n.delayDraw((function(){g.clearRect(0,0,t,o),g.fillStyle="white",g.fillRect(0,0,t,o),g.drawImage(d,0,0,t,o),a.Logger.info(h("draw_ppt"),JSON.stringify({p:n.ppth5Info.page,vpage:e,w:t,h:o})),c()})),d.onerror=function(i){n.changeImageCDNHost(d,p,"ppt",e)||(g.clearRect(0,0,t,o),n.drawImgError(g,t,o,0,e),l(i))},d.src=/^https?:\/\//.test(i)?i+"?p="+e:"data:image/png;base64,"+i}))},e.prototype.drawPDF=function(e,t,o,i,r,n,a){var h=this;if(this.vpageDrawImgCache[t])return Promise.resolve();var c=this.getCanvasSplit(e),l=c.index,p=c.start,g=c.end;if(e<p||e>g)return Promise.resolve();o*=s.RENDER_MAX_ZOOM,i*=s.RENDER_MAX_ZOOM,r*=s.RENDER_MAX_ZOOM,n*=s.RENDER_MAX_ZOOM;var d=this.vpageAspecCache[this.viewInfo.sheet],f=this.canvasArray[l].getContext("2d");return t-=d.vs-1,new Promise((function(s,c){var l={},p=new Image;p.setAttribute("crossOrigin","anonymous"),p.onload=h.delayDraw((function(){h.clearImgError(f,r,n,i),f.fillStyle="white",d.o?(f.fillRect(o,0,r,n),f.drawImage(p,o,0,r,n)):(f.fillRect(0,i,r,n),f.drawImage(p,0,i,r,n)),h.vpageDrawImgCache[t]=1,t>1&&t===d.p[e-1]+1&&h.drawDividingLine(f,e,o,i,r,n,d.o),s()})),p.onerror=function(s){h.changeImageCDNHost(p,l,"pdf",t)||(h.drawImgError(f,r,n,i,t),h.vpageDrawImgCache[t]=0,t>1&&t===d.p[e-1]+1&&h.drawDividingLine(f,e,o,i,r,n,d.o),c(s))},p.src=/^https?:\/\//.test(a)?a+"?p="+t:"data:image/png;base64,"+a}))},e.prototype.drawImg=function(e,t){var o=this;return new Promise((function(i,r){var n={},c=o.viewInfo,l=c.parentWidth,p=c.parentHeight,g=c.viewWidth,d=c.viewHeight,f=c.rate,u=o.vpageAspecCache[0][1],v=t.getContext("2d"),w=new Image;if(w.setAttribute("crossOrigin","anonymous"),w.onload=function(){var e=o.viewInfo.imgInfo,r=e.min_w,n=e.min_h,c=w.width,m=w.height,D=m/c,y=c<=r&&m<=n,I=c<=1440&&D<=2.2&&D>=614/1280;if(o.viewInfo.imgInfo.isSmall=y,o.viewInfo.imgInfo.isScale=I,o.viewInfo.imgInfo.width=c,o.viewInfo.imgInfo.height=m,o.clearImgError(v,g*s.RENDER_MAX_ZOOM,d*s.RENDER_MAX_ZOOM,0),y||I){var E=y?Math.min(r,l)/c:l/c,T=y?Math.min(n,p)/m:p/m,S=Math.min(E,T),V=(l-(M=c*S|0))/2,P=(p-(C=m*S|0))/2;Object.assign(u,{x:V,y:P,w:M,h:C}),o.viewInfo.height=u.h,o.updateDocsViewLayout(V,P,M,C),o.setCanvasWidthHeight(t,M,C),v.fillStyle="white",v.fillRect(0,0,t.width,t.height),v.drawImage(w,0,0,t.width,t.height),a.Logger.info(h("draw_img_scale"),JSON.stringify({width:c,height:m,draw_w:M,draw_h:C,rate:S}))}else{var M=c*f|0,C=m*f|0;P=Math.max((p-C)/2,0);Object.assign(u,{x:0,y:P,w:l,h:C}),o.viewInfo.height=u.h,o.updateDocsViewLayout(0,P,l,Math.min(p,C)),o.setCanvasWidthHeight(t,l,C),v.fillStyle="white",v.fillRect(0,0,t.width,t.height),v.drawImage(w,0,0,t.width,t.height),a.Logger.info(h("draw_img_full"),JSON.stringify({width:c,height:m,draw_w:M,draw_h:C,rate:f}))}var Z=o.getFile();Z.max_width=u.w,Z.total_height=u.h,i()},/^https?:\/\//.test(e)){var m=function(){o.setCanvasWidthHeight(t,l,p),o.drawImgError(v,t.width,t.height,0,1),r()};o.serviceHandle.decryptImage(e).then((function(e){return w.src=e})).catch((function(){return o.changeDecryptImageCDNHost(w,n,e,m)}))}else w.onerror=function(){o.changeImageCDNHost(w,n,"img")||(o.setCanvasWidthHeight(t,l,p),o.drawImgError(v,t.width,t.height,0,1),r())},w.src="file://"+e}))},e.prototype.createDocsView=function(){var e=s.DOMIDS.doc+this.id;if(!document.getElementById(e)){this.canvasArray=[],this.vpageDrawImgCache={};var t=document.createElement("div");t.id=s.DOMIDS.render+this.id,this.renderDom=t,(t=document.createElement("div")).id=e,t.setAttribute("data-page",this.viewInfo.total+""),t.setAttribute("data-mode",this.renderMode+""),t.addEventListener(s.DomEvent.Whiteboard,this.handleWhiteboardEvent),this.docDom=t;var o=document.createElement("div");o.id=s.DOMIDS.zoom+this.id,o.appendChild(this.renderDom),this.createImageLoading(o),o.appendChild(this.docDom),document.getElementById(this.parent).appendChild(o),t.addEventListener("scroll",this.handleScrollEvent),t.addEventListener("mousedown",this.handleDragStart),t.addEventListener("mousemove",this.handleDragMove),t.addEventListener("mouseup",this.handleDragEnd),t.addEventListener("mouseleave",this.handleDragEnd),t.addEventListener("touchstart",this.handleDragStart),t.addEventListener("touchmove",this.handleDragMove),t.addEventListener("touchend",this.handleDragEnd),t.addEventListener("touchcancel",this.handleDragEnd)}},e.prototype.createImageLoading=function(e){if(this.renderMode===s.RenderMode.PDF||this.renderMode===s.RenderMode.PPT){var t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("xmlns","http://www.w3.org/2000/svg"),t.setAttribute("version","1.1"),t.setAttribute("viewBox","0 0 1024 1024"),t.setAttribute("width","48"),t.setAttribute("height","48"),t.setAttribute("class","loading"),t.innerHTML=n.IMG_LOADING,this.loadingDom=t,e.appendChild(this.loadingDom)}},e.prototype.showImageLoading=function(e){this.loadingDom.style.display=e?"block":"none"},e.prototype.hideOtherDocsView=function(){var e=document.getElementById(this.parent);if(e){var t=s.DOMIDS.zoom+this.serviceHandle.getStore().activitedId;Array.from(e.children||e.childNodes).forEach((function(e){e.style.display=e.id==t?"block":"none"}))}},e.prototype.updateDocsViewLayout=function(e,t,o,i){e|=0,t|=0,o|=0,i|=0,this.viewInfo.width=o,this.viewInfo.viewWidth=o,this.viewInfo.viewHeight=i;var r="width:"+o+"px;height:"+i+"px;";this.docDom.style.cssText+=r,this.renderDom.style.cssText+=r,this.docDom.parentElement.style.cssText=r+"left:"+e+"px;top:"+t+"px;",a.Logger.info(h("layout"),JSON.stringify({x:e,y:t,w:o,h:i,h0:this.viewInfo.height}))},e.prototype.setCanvasWidthHeight=function(e,t,o){e.style.cssText+="width:"+t+"px;height:"+o+"px;",e.width=t*s.RENDER_MAX_ZOOM,e.height=o*s.RENDER_MAX_ZOOM},e.prototype.createCanvas=function(){if(this.canvasArray.length)return!1;var e=document.createElement("canvas");e.setAttribute("data-i","0"),this.canvasArray.push(e);var t=this.viewInfo,o=t.parentWidth,i=t.parentHeight,r=t.height,n=t.sheet,c=t.canvasMaxPage,l=t.fillPPT,p=this.getFileType();if(p===s.ZegoDocsViewFileType.ZegoDocsViewFileTypeIMG)return this.updateDocsViewLayout(0,0,o,i),!0;var g=this.vpageAspecCache[0][1],d=g.x,f=g.y,u=g.w,v=g.h;if(this.renderMode===s.RenderMode.PPT)this.setCanvasWidthHeight(e,u,v),this.updateDocsViewLayout(d,f,u,v);else{var w=l?u:o;this.setCanvasWidthHeight(e,w,this.getCanvasHeight(0));var m=this.getPageCount();if(m>c){m=Math.ceil(m/c);for(var D=0,y=this.vpageAspecCache[n],I=0;I<m;I++)D+=this.getCanvasHeight(I);if(D=r-D,Math.abs(D)>10&&m>2){var E=D>0?1:-1;D*=E;var T=Math.ceil(m>D?m/D:1);E=1==T?Math.round(E*D/m):E;var S="diff="+D+",step="+T+",count="+m+",equal="+this.getFile().isEqualAspec;a.Logger.info(h("pdf_diff_canvas"),S);for(I=1;I<=m;)y.h[I]+=E,I+=T}for(I=1;I<m;I++){var V=document.createElement("canvas");V.setAttribute("data-i",I+"");var P=l?u:o;this.setCanvasWidthHeight(V,P,this.getCanvasHeight(I)),this.canvasArray.push(V)}}if(p===s.ZegoDocsViewFileType.ZegoDocsViewFileTypeELS&&this.getDocViewChild())this.resetVisibleSize();else if(l)this.updateDocsViewLayout(d,f,u,v);else{var M=Math.max((i-r)/2,0),C=Math.min(i,r);this.updateDocsViewLayout(0,M,o,C)}}return!0},e.prototype.renderCanvas=function(){var e=this.zoomInfo.zoom,t=this.viewInfo,o=t.width,i=t.height,r=this.getDocViewChild(),n=!!r,a="width:"+o+"px;height:"+i+"px;"+(e>1?"transform:scale("+e+");":"");if(r||(r=document.createElement("div"),this.docDom.appendChild(r)),r.style.cssText=a,n){if(this.getFileType()==s.ZegoDocsViewFileType.ZegoDocsViewFileTypeELS){var h=document.createDocumentFragment();this.canvasArray.forEach((function(e){return h.appendChild(e)})),(r=this.renderDom.firstChild).style.cssText=a,r.innerHTML="",r.appendChild(h)}}else if(this.renderMode===s.RenderMode.PPT)this.renderDom.appendChild(this.canvasArray[0]);else{var c=document.createDocumentFragment();(r=document.createElement("div")).style.cssText=a,this.canvasArray.forEach((function(e){return r.appendChild(e)})),c.appendChild(r),this.renderDom.appendChild(c)}this.setDocsViewDomOverflow(),this.viewInfo.firstInfo.scrollTop>0&&this.handleScroll(this.viewInfo.firstInfo.scrollTop),this.viewInfo.firstInfo.scrollTop=-1},e.prototype.drawCanvas=function(e,t){var o=this,i=this.renderMode===s.RenderMode.PPT;i&&(e=e.filter((function(e){return e.virtual_page_number===o.ppth5Info.page}))),this.createDocsView(),this.showImageLoading(!0);for(var r=this.createCanvas(),n=this.canvasArray[0],c=0,l=0,p={id:this.id},g=[],d=this.vpageAspecCache[this.viewInfo.sheet],f=0;f<e.length;++f){var u=e[f],v=u.image_data,w=u.image_path,m=u.virtual_page_number;if(v)if(i){var D=d[m],y=D.w,I=D.h,E=this.drawPPT(m,y,I,v,n);g.push(E)}else{var T=d[m],S=T.p;y=T.w,I=T.h,E=this.drawPDF(S,m,l,c,y,I,v);g.push(E),c+=I,l+=y,p[m]=this.vpageDrawImgCache[m]}else if(w){E=this.drawImg(w,n);g.push(E)}}this.canvasArray.length>1&&a.Logger.info(h("draw_cache"),JSON.stringify(p));var V=function(){o.docDom&&r&&o.renderCanvas(),o.hideOtherDocsView(),t&&t(),o.showImageLoading(!1)};Promise.all(g).then(V,V)},e.prototype.drawHtml=function(e,t){var o=this;this.createDocsView();var i=s.DOMIDS.iframe+this.id;if(!document.getElementById(i)){var r=this.vpageAspecCache[0][1],n=r.x,a=r.y,h=r.w,c=r.h,l=this.getFile().page_list[0].width;(this.isTouch||h-l>4)&&(this.ppth5Info.scale=Number((h/l).toFixed(4))),this.createIFrame(i,h,c),this.iframeDom.src=e[0].image_data+"#"+this.id,this.ppth5Info.loadRetryTimer&&clearTimeout(this.ppth5Info.loadRetryTimer),this.ppth5Info.loadRetryTimer=window.setTimeout((function(){return o.changeH5CDNHost()}),s.PPT_LOAD_TIME);var p="width:"+h+"px;height:"+this.viewInfo.height+"px;",g=document.createElement("div");g.style.cssText=p,this.docDom.appendChild(g),this.renderDom.style.zIndex="1",this.renderDom.appendChild(this.iframeDom),this.updateDocsViewLayout(n,a,h,c),this.setDocsViewDomOverflow(),window.addEventListener("message",this.handleIframeMessage)}this.hideOtherDocsView(),t&&t()},e.prototype.createIFrame=function(e,t,o){var i=document.createElement("iframe");i.id=e,i.allow="autoplay",i.width=t+"",i.height=o+"",this.iframeDom=i},e.prototype.execDraw=function(e,t){var o=this,i=e,r=e;if(this.renderMode===s.RenderMode.PDF){var n=this.getCanvasSplit(e);i=n.start,r=n.end}var a=this.getAllVirtualInPageRange(i-1,r-1);this.startGetImageByVirtualPageList(a,(function(e){o.renderMode===s.RenderMode.H5_PPT||o.renderMode===s.RenderMode.H5_CUSTOM?o.drawHtml(e,t):o.drawCanvas(e,t)}))},e.prototype.execScrollFileAndDraw=function(e,t,o){var i=this;if(this.canvasArray.length>1){var r=Date.now(),n=r-this.viewInfo.lastTime;if(this.viewInfo.lastTime=r,n<s.INTERVAL_PAGE)return this.viewInfo.lastTimeId&&clearTimeout(this.viewInfo.lastTimeId),void(this.viewInfo.lastTimeId=window.setTimeout((function(){o?o.forEach((function(e){return i.execDraw(e,t)})):i.execDraw(i.ppth5Info.page,t);var r={p:i.ppth5Info.page,page:e,zoom:i.zoomInfo.zoom,pages:o};a.Logger.info(h("draw_scrolled"),JSON.stringify(r))}),s.INTERVAL_PAGE))}this.execDraw(e,t)},e.prototype.onScrollCallback=function(e,t){var o=this.viewInfo,i=o.total,r=o.width,n=o.height,s=o.viewHeight,a=o.scrollTop;if(n>s){var h=this.zoomInfo.zoom,c=this.getPageByScrollTop(t),l=Number((t/n/h).toFixed(7));this.ppth5Info.page=c,this.triggerOnScrollEventListener(t,c,l);var p=e&&Number((e/r/h).toFixed(7));if(this.postPageChangeMessage(p),this.ppth5Info.page!==c){if(this.execScrollFileAndDraw(c),this.viewInfo.isParentScale)(g=document.getElementById(this.parent))&&this.drawPDFBlank(g.clientHeight,t/h)}else if(c>1&&c<i)if(this.viewInfo.isParentScale){var g;(g=document.getElementById(this.parent))&&this.drawPDFBlank(g.clientHeight,t/h)}else{var d=t>a*h?1:-1;this.getCanvasSplit(c).index!==this.getCanvasSplit(c+d).index&&this.execScrollFileAndDraw(c+d)}}else this.postSyncDragMessage(e,t)},e.prototype.getLoadFileModelForAPI=function(e){this.fileInfo.file_id=e.file_id;var t={parent:this.parent,fileID:e.file_id,fileName:e.file_list[0].file_name,fileType:e.file_type,fileUrls:e.file_urls,pageCount:e.file_list[0].page_count,width:e.width,height:e.height};return e.file_hash?t.fileHash=e.file_hash:t.seq=e.seq,e.file_type===s.ZegoDocsViewFileType.ZegoDocsViewFileTypeELS&&(t.name=e.file_list[0].name,t.sheets=e.file_list.map((function(e){return e.file_name}))),t},e.prototype.getLoadFileModelForCallback=function(){var e,t=this.viewInfo,o=t.width,i=t.height,r=this.getFile(),n=this.getFileType(),a={parent:this.parent,fileID:this.fileInfo.file_id,fileName:r.file_name,fileType:n,pageCount:r.page_count,width:o,height:i,viewID:s.DOMIDS.doc+this.id};this.fileInfo.file_hash?a.fileHash=this.fileInfo.file_hash:a.seq=this.fileInfo.seq;var h=((e={fileID:a.fileID})[a.fileName]={width:o,height:i,pageCount:a.pageCount},e);return n===s.ZegoDocsViewFileType.ZegoDocsViewFileTypeELS&&(a.name=r.name,a.sheets=this.fileInfo.file_list.map((function(e){return h[e.file_name]={width:e.max_width,height:e.total_height,pageCount:e.page_count},e.file_name}))),document.body.dispatchEvent(new CustomEvent("loadfile",{detail:h})),a},e.prototype.loadCurrentSheet=function(e,t){var o=this.getFile();if(o){var i=this.getFileType();this.viewInfo.width=o.max_width,this.viewInfo.height=o.total_height,this.viewInfo.total=o.page_count,this.viewInfo.rate=o.rate,i===s.ZegoDocsViewFileType.ZegoDocsViewFileTypePPT?this.renderMode=s.RenderMode.PPT:i===s.ZegoDocsViewFileType.ZegoDocsViewFileTypeDynamicPPTH5?this.renderMode=s.RenderMode.H5_PPT:i===s.ZegoDocsViewFileType.ZegoDocsViewFileTypeCustomH5&&(this.renderMode=s.RenderMode.H5_CUSTOM),i===s.ZegoDocsViewFileType.ZegoDocsViewFileTypeELS&&t&&(this.docDom.scrollTop=0,this.renderDom.scrollTop=0,this.canvasArray.length=0),this.execScrollFileAndDraw(this.ppth5Info.page,e?this.loadFileCallback:void 0)}},e.prototype.resetDocsViewLayout=function(e,t){var o=this.viewInfo,i=o.parentWidth,r=o.parentHeight,n=o.viewWidth,s=o.viewHeight;if(Math.abs(e-n)<5&&Math.abs(t-s)<5){var c=(i-e)/2,l=(r-t)/2;return this.docDom.parentElement.style.cssText+="left:"+c+"px;top:"+l+"px;",a.Logger.info(h("reloadViewLayou"),JSON.stringify({w0:n,h0:s,w:e,h:t})),!1}return!0},e.prototype.canReloadView=function(){var e=this.viewInfo.viewWidth;this.setParentWidthHeight(this.parent);var t=this.viewInfo,o=t.parentWidth,i=t.parentHeight,r=t.height,n=t.viewHeight;if(this.renderMode===s.RenderMode.PPT||this.renderMode===s.RenderMode.H5_PPT||this.renderMode===s.RenderMode.H5_CUSTOM||this.viewInfo.fillPPT){var c=this.fileInfo.file_list[0].page_list[0],l=c.width;return((I=c.height*(y=o)/l)>i||Math.abs(I-i)<=1)&&(y=i*o/I|0,I=i),I|=0,this.resetDocsViewLayout(y,I)}if(this.getFileType()===s.ZegoDocsViewFileType.ZegoDocsViewFileTypeIMG){var p=this.viewInfo.imgInfo,g=p.isSmall,d=p.isScale,f=(l=p.width,p.height),u=p.min_w,v=p.min_h;if(g||d){var w=g?Math.min(u,o)/l:o/l,m=g?Math.min(v,i)/f:i/f,D=Math.min(w,m),y=l*D|0,I=f*D|0;return this.resetDocsViewLayout(y,I)}}if(Math.abs(o-e)<5){var E=Math.max((i-r)/2,0),T=Math.min(i,r);return this.updateDocsViewLayout(0,E,o,T),a.Logger.info(h("reloadViewLayou"),JSON.stringify({w0:e,h0:n,w:o,h:T})),!1}return!0},e.prototype.checkPPT2PDF=function(e,t){if(e===s.ZegoDocsViewFileType.ZegoDocsViewFileTypePDF){var o=t.page_list[0],i=o.width,r=o.height,n=Number((r/i).toFixed(3));if(n<=1&&n>=614/1280)return t.page_list.map((function(e){return Number((e.height/e.width).toFixed(3))})).every((function(e){return e===n}))}return!1},e.prototype.calculateFileAspec=function(e,t){var o=e.page_list[0],i=o.width,r=o.height,n=i,s=r,a=i,h=r;if(!t){n=0,s=0,a=Number.MAX_SAFE_INTEGER,h=Number.MAX_SAFE_INTEGER;for(var c=0,l=e.page_list;c<l.length;c++){var p=l[c];p.width>n&&(n=p.width),p.width<a&&(a=p.width),p.height>s&&(s=p.height),p.height<h&&(h=p.height)}}return e.origin_max_width=n,e.max_width=n,e.min_width=a,e.max_height=s,e.min_height=h,e.rate=this.viewInfo.parentWidth/n,e},e.prototype.init=function(e,t){var o=this;this.parent=e,this.id=t,this.ppth5Info.p=e,this.serviceHandle.registerEventHandler(this.id,s.DocsListener.Load,(function(e){o.tranlateFileAspec(e),Object.assign(o.fileInfo,e),o.checkRenderType(),o.loadCurrentSheet(!0)}))},e.prototype.checkRenderType=function(){8==this.fileInfo.expect_file_type&&this.postErrorMessage(s.ZegoDocsViewError.ZegoDocsViewErrorUnsupportRenderType)},e.prototype.tranlateFileAspec=function(e){this.setParentWidthHeight(this.parent);for(var t=e.file_type,o=this.viewInfo,r=o.sheetName,n=o.parentWidth,a=o.parentHeight,h=function(o){var h={vs:1,p:{0:0},h:{}};c.vpageAspecCache[o]=h;var l=e.file_list[o];if(t===s.ZegoDocsViewFileType.ZegoDocsViewFileTypeELS?(l.page_count=l.page_list.length,l.file_name===r&&(c.viewInfo.sheet=o)):l.page_count||(l.page_count=l.page_list.length),t===s.ZegoDocsViewFileType.ZegoDocsViewFileTypePPT||t===s.ZegoDocsViewFileType.ZegoDocsViewFileTypeDynamicPPTH5||t===s.ZegoDocsViewFileType.ZegoDocsViewFileTypeCustomH5){var p=l.page_list[0],g=p.width;((w=p.height*(v=n)/g)>a||Math.abs(w-a)<=1)&&(v=a*n/w|0,w=a),l.max_width=v,l.total_height=w*l.page_count|0,l.rate=n/g;for(var d={p:1,x:(n-v)/2,y:(a-(w|=0))/2,w:v,h:w},f=1;f<=l.page_count;++f)h[f]=i(i({},d),{p:f}),h.p[f]=1}else{h.vs=l.page_list[0].virtual_page_list[0].virtual_page_number,h.o=!1;var u=c.checkPPT2PDF(t,l);if(c.viewInfo.fillPPT=u,u){var v,w,m=l.page_list[0];g=m.width;((w=m.height*(v=n)/g)>a||Math.abs(w-a)<=1)&&(v=a*n/w|0,w=a),l.isEqualAspec=!0,l.max_width=v,l.total_height=w*l.page_count|0,l.rate=n/g;var D={p:1,x:(n-v)/2,y:(a-(w|=0))/2,w:v,h:w},y=h.vs-1;l.page_list.forEach((function(e,t){y+=e.virtual_page_list.length,h.p[t+1]=y;for(var o=0,r=e.virtual_page_list;o<r.length;o++){var n=r[o];h[n.virtual_page_number]=i(i({},D),{p:t+1})}}))}else{var I=c.calculateFileAspec(l,u),E=I.max_width,T=I.min_width,S=I.max_height,V=I.min_height,P=Math.abs(E-T)<5&&Math.abs(S-V)<5,M=P?l.page_count*S*n/T:0,C=h.vs-1;l.page_list.forEach((function(e,t){var o=e.virtual_page_list.length;C+=o,h.p[t+1]=C;var i={p:t+1,x:0,y:0,w:n};P?i.h=Number((M/l.page_count/o).toFixed(4)):(i.h=Number((e.height*n/E/o).toFixed(4)),M+=e.height*n/E);for(var r=0,s=e.virtual_page_list;r<s.length;r++){var a=s[r];h[a.virtual_page_number]=i}})),l.isEqualAspec=P,l.max_width=n,l.total_height=Math.round(M)}var Z=Math.floor(16e3*l.page_count/(s.RENDER_MAX_ZOOM*l.total_height))||1;c.viewInfo.canvasMaxPage=Z}},c=this,l=0;l<e.file_list.length;++l)h(l)},e.prototype.handleScroll=function(e,t,o){var i=this;if(this.docDom){var r=this.zoomInfo,n=r.zoom,a=r.enableScroll,h=this.viewInfo,c=h.height,l=h.total,p=this.ppth5Info.page,g=this.renderMode===s.RenderMode.PDF;if(g&&(a&&(this.viewInfo.ticking=!0,clearTimeout(this.viewInfo.scrollTimeId),this.viewInfo.scrollTimeId=window.setTimeout((function(){return i.viewInfo.ticking=!1}),34)),this.docDom.scrollTop=e,this.renderDom.scrollTop=e,this.viewInfo.scrollTop=Math.ceil(e/n)),this.renderMode===s.RenderMode.PDF||this.renderMode===s.RenderMode.PPT){if(this.viewInfo.isParentScale){this.execScrollFileAndDraw(p);var d=document.getElementById(this.parent);d&&this.drawPDFBlank(d.clientHeight,this.viewInfo.scrollTop)}else this.execScrollFileAndDraw(p);t="number"==typeof t?t:Number((g?e/c/n:(p-1)/l).toFixed(7)),this.triggerOnScrollEventListener(e,p,t),this.postPageChangeMessage(o)}}},e.prototype.getScrollTopByPage=function(e){var t=this.zoomInfo.zoom;if(this.viewInfo.total<=1||e<=1)return this.updateCurViewMax(0,t),0;if(this.renderMode!==s.RenderMode.PDF)return(e-1)*this.viewInfo.viewHeight*t+2;for(var o=this.vpageAspecCache[this.viewInfo.sheet],i=o.p[e-1],r=0,n=o.vs;n<=i;n++)r+=o[n].h;return r*=t,this.updateCurViewMax(r,t),r},e.prototype.getPageByScrollTop=function(e){var t=this.viewInfo,o=t.sheet,i=t.viewHeight,r=t.total,n=this.zoomInfo.zoom,a=this.getFileType(),h=Math.ceil(.5*i);if(a===s.ZegoDocsViewFileType.ZegoDocsViewFileTypeIMG)return 1;if(this.renderMode!==s.RenderMode.PDF)return Math.round(e/n/i)+1;for(var c=this.vpageAspecCache[o],l=-h,p=c.vs;l<=e&&c[p];)l+=c[p].h*n,p++;return Math.min(r,Math.max(1,c[p-1].p))},e.prototype.getDocViewChild=function(){return this.docDom.firstChild},e.prototype.postWhiteboardMessage=function(e,t){if(this.wbId){var o={action:e,data:t};this.docDom.dispatchEvent(new CustomEvent(s.DomEvent.Docs,{detail:o}))}},e.prototype.postSyncDragMessage=function(e,t,o){if(o||this.renderMode===s.RenderMode.PDF||(this.zoomInfo.tx=e,this.zoomInfo.ty=t),this.wbId){var i={action:s.DomEventAction.SyncDrag,x:e,y:t,scale:this.zoomInfo.zoom,notify:this.ppth5Info.notify};this.docDom.dispatchEvent(new CustomEvent(s.DomEvent.Docs,{detail:i}))}},e.prototype.postPageChangeMessage=function(e){if(this.wbId){var t={action:s.DomEventAction.Page,page:this.ppth5Info.page,step:this.ppth5Info.step,pageCount:this.viewInfo.total,ofsX:e,percent:this.viewInfo.percent,notify:this.ppth5Info.notify};this.docDom.dispatchEvent(new CustomEvent(s.DomEvent.Docs,{detail:t})),this.renderMode!==s.RenderMode.PDF&&this.setDocsViewDomTransform(this.zoomInfo.tx,this.zoomInfo.ty)}},e.prototype.postStepChangeMessage=function(){var e={parent:this.parent,page:this.ppth5Info.page,step:this.ppth5Info.step,fileID:this.getFileID(),fileType:this.getFileType(),fileName:this.getFile().file_name,notify:this.ppth5Info.notify};this.ppth5Info.scene&&(e.scene=this.ppth5Info.scene),this.serviceHandle.triggerEventListener(s.ZegoEventType.StepChange,e),this.triggerH5OnScrollEventListener(),this.postPageChangeMessage(),this.ppth5Info.scene=0},e.prototype.postErrorMessage=function(e){if(e="object"==typeof e?e:s.transError(e),String(e.code).startsWith("3"))this.postWhiteboardMessage(s.DomEventAction.WbError,e.code);else{var t=i({parent:this.parent,fileID:this.getFileID(),fileType:this.getFileType(),fileName:this.getFile().file_name},e);this.serviceHandle.triggerEventListener(s.ZegoEventType.Error,t)}},e.prototype.triggerOnScrollEventListener=function(e,t,o){this.viewInfo.percent=o;var i=this.getFile(),r={parent:this.parent,percent:o,page:t,y:e,fileID:this.fileInfo.file_id,fileType:this.getFileType(),fileName:i.file_name,name:i.name||""};this.serviceHandle.triggerEventListener(s.ZegoEventType.Scroll,r)},e.prototype.triggerH5OnScrollEventListener=function(){var e=this.ppth5Info.page,t=(e-1)*this.viewInfo.viewHeight,o=Number(((e-1)/this.viewInfo.total).toFixed(7));this.triggerOnScrollEventListener(t,e,o)},e.prototype.postMessage2iframe=function(e,t){var o=this.iframeDom;o&&o.contentWindow&&o.contentWindow.postMessage({source:"zegodocsview",action:e,args:t||[]},"*")},e.prototype.handleWhiteboardPageEvent=function(e){var t=e.percent,o=e.step,i=e.notify,r=e.ofsX,n=e.ofsY;this.ppth5Info.notify=i;var c=0,l=1;i?(l=Math.min(Math.round(t*this.viewInfo.total)+1,this.viewInfo.total),c=this.getScrollTopByPage(l)):(c=Math.floor((t+n)*this.viewInfo.height*this.zoomInfo.zoom),l=this.getPageByScrollTop(c));var p={oldpage:this.ppth5Info.page,oldstep:this.ppth5Info.step,page:l,step:o};if(a.Logger.info(h(s.DomEvent.Whiteboard+"_page"),JSON.stringify(p)),this.renderMode===s.RenderMode.H5_PPT||this.renderMode===s.RenderMode.H5_CUSTOM)this.syncWhiteboardPPTH5Queue(l,o);else{this.ppth5Info.page=l;var g=i&&this.renderMode===s.RenderMode.PDF?r:void 0;this.handleScroll(c,t,g)}},e.prototype.handleWhiteboardDragToolEvent=function(e){var t=e.enable,o=this.zoomInfo.enableScroll;this.zoomInfo.enableScroll=t,this.zoomInfo.remoteScroll=e.remoteScroll,this.zoomInfo.isDrag=e.isDrag,o!==t&&(this.setDocsViewDomOverflow(),this.postMessage2iframe(s.H5ScriptEvents.SetCustomizedConfig,[s.H5ScriptConfig.PptOperationAuth,JSON.stringify({scroll:+t})]))},e.prototype.handleWhiteboardInitEvent=function(e){var t=this;this.wbId=e.data,setTimeout((function(){var e={action:s.DomEventAction.DocsAspect,data:JSON.parse(JSON.stringify(t.vpageAspecCache[t.viewInfo.sheet]))};t.docDom.dispatchEvent(new CustomEvent(s.DomEvent.Docs,{detail:e}))}))},e.prototype.handleWhiteboardAnimationEvent=function(e){this.ppth5Info.notify=!1,e.notify?(this.viewInfo.firstInfo.page=this.ppth5Info.page,this.viewInfo.firstInfo.step=this.ppth5Info.step,this.viewInfo.firstInfo.h5Extra=e.data):this.playAnimation(e.data)},e.prototype.tryInitPageStep=function(e,t){var o=this;if(this.ppth5Info.goPage&&this.ppth5Info.goStep){if(this.ppth5Info.goTimer&&clearTimeout(this.ppth5Info.goTimer),this.ppth5Info.goPage===e&&this.ppth5Info.goStep===t)return void(this.ppth5Info.goPage=this.ppth5Info.goStep=0);this.ppth5Info.goTimer=window.setTimeout((function(){var i=o.ppth5Info,r=i.goPage,n=i.goStep;r&&n&&(o.execGotoPage(r,n,!1),a.Logger.info(h("h5_init_timeout"),JSON.stringify({id:o.id,page:e,step:t,h5:o.ppth5Info})))}),2e3)}},e.prototype.syncCurrentPageStep=function(e){var t=!1;if(!this.ppth5Info.loaded){a.Logger.info(h("h5_init_page"),JSON.stringify({id:this.id,h5:this.ppth5Info})),this.ppth5Info.loaded=!0;var o=this.ppth5Info,i=o.targetPage,r=o.targetStep;i&&r&&(this.ppth5Info.page=i,this.ppth5Info.step=r,this.gotoPage(!1),t=!0)}!t&&Object.assign(this.ppth5Info,e),this.ppth5Info.page===this.ppth5Info.targetPage&&this.ppth5Info.step===this.ppth5Info.targetStep&&(this.ppth5Info.targetPage=0,this.ppth5Info.targetStep=0),t||(this.firstNeedPlayAnimation(),this.postStepChangeMessage(),this.execSyncPPTH5Queue())},e.prototype.syncCurrentPage=function(e){var t=this;if(this.ppth5Info.loaded){"boolean"==typeof e.notify&&(this.ppth5Info.notify=e.notify);var o=+e.page+1,i=(e.step||0)+1;this.ppth5Info.pageChangeTimer&&clearTimeout(this.ppth5Info.pageChangeTimer),this.ppth5Info.pageChangeTimer=window.setTimeout((function(e){t.ppth5Info.page=e[0],t.ppth5Info.step=e[1],t.ppth5Info.scene=e[2],t.postStepChangeMessage()}),2e3,[o,i,e.scene]),this.tryInitPageStep(o,i)}else{a.Logger.info(h("h5_init_page"),JSON.stringify({id:this.id,h5:this.ppth5Info})),this.ppth5Info.loaded=!0;var r=this.ppth5Info,n=r.targetPage,s=r.targetStep;n>1?(this.ppth5Info.goPage=n,this.ppth5Info.goStep=s,this.ppth5Info.page=n,this.gotoPage(!1)):s<=1&&(this.postStepChangeMessage(),this.firstNeedPlayAnimation())}},e.prototype.syncCurrentStep=function(e){this.ppth5Info.pageChangeTimer&&clearTimeout(this.ppth5Info.pageChangeTimer);var t=e.page+1,o=+e.step+1,i=this.ppth5Info.lastStep;if(this.ppth5Info.lastStep=t===this.ppth5Info.page?o:-1,0!=o&&(0!=i||1!=o)&&("boolean"==typeof e.notify&&(this.ppth5Info.notify=e.notify),a.Logger.info(h("h5_step"),JSON.stringify({id:this.id,page:t,step:o,notify:e.notify,h5:this.ppth5Info})),o===this.ppth5Info.step&&t===this.ppth5Info.page||(this.ppth5Info.page=t,this.ppth5Info.step=o,this.tryInitPageStep(t,o),this.ppth5Info.targetPage||this.ppth5Info.targetStep||(a.Logger.info(h("h5_queue_done"),JSON.stringify({id:this.id,page:t,step:o,action:"step"})),this.firstNeedPlayAnimation(),this.postStepChangeMessage(),this.execSyncPPTH5Queue(),this.execMultiDocsQueue())),this.ppth5Info.page===this.ppth5Info.targetPage)){var r="h5step:"+t+","+o+"-"+this.ppth5Info.page+","+this.ppth5Info.targetStep+")";this.ppth5Info.targetStep<o?this.previousStep(this.ppth5Info.notify,r):this.ppth5Info.targetStep>o?this.nextStep(this.ppth5Info.notify,r):(this.ppth5Info.targetPage=0,this.ppth5Info.targetStep=0,this.ppth5Info.goPage=0,this.ppth5Info.goStep=0,a.Logger.info(h("h5_queue_done"),JSON.stringify({id:this.id,page:t,step:o,action:"page"})),this.firstNeedPlayAnimation(),this.postStepChangeMessage(),this.execSyncPPTH5Queue(),this.execMultiDocsQueue())}},e.prototype.syncCurrentElement=function(e){var t={parent:this.parent,page:this.ppth5Info.page,step:this.ppth5Info.step,fileID:this.getFileID(),fileType:this.getFileType(),fileName:this.getFile().file_name,data:e};if(this.serviceHandle.triggerEventListener(s.ZegoEventType.PlayAnimation,t),this.wbId){var o={action:s.DomEventAction.Animation,data:e,notify:!0};this.docDom.dispatchEvent(new CustomEvent(s.DomEvent.Docs,{detail:o}))}},e.prototype.syncCurrentError=function(e){e.code===s.ZegoDocsViewError.ZegoDocsViewErrorNetworkTimeout?(this.ppth5Info.loadRetryTimer&&clearTimeout(this.ppth5Info.loadRetryTimer),this.changeH5CDNHost()):this.postErrorMessage(e)},e.prototype.initIframe=function(){var e=this;this.postMessage2iframe(s.H5ScriptEvents.InitPlatform,[4]),this.postMessage2iframe(s.H5ScriptEvents.GetAllPageStepCount),this.renderMode===s.RenderMode.H5_PPT&&this.postMessage2iframe(s.H5ScriptEvents.SetCustomizedConfig,[s.H5ScriptConfig.Scale,this.ppth5Info.scale]),this.domEventListeners&&this.postMessage2iframe(s.H5ScriptEvents.SetCustomizedConfig,[s.H5ScriptConfig.SyncDOMEvent]),this.postMessage2iframe(s.H5ScriptEvents.SetCustomizedConfig,[s.H5ScriptConfig.PptOperationAuth,JSON.stringify({scroll:+this.zoomInfo.enableScroll})]);var t=this.serviceHandle.getStore();[s.ZegoConfigKey.UnloadVideoSrc,s.ZegoConfigKey.PptStepMode,s.ZegoConfigKey.DisableH5ImageDrag].forEach((function(o){return e.postMessage2iframe(s.H5ScriptEvents.SetCustomizedConfig,[o,t[o]])}))},e.prototype.dragPDF=function(e,t){var o=this.zoomInfo,i=o.tx,r=o.ty,n=o.zoom,a=o.enableScroll,h=o.remoteScroll,c=o.dragRectTop,l=o.dragRectBottom,p=this.viewInfo,g=p.width,d=p.height,f=p.viewHeight,u=p.percent,v=e instanceof MouseEvent?e:e.changedTouches[0],w=v.clientX,m=v.clientY,D=i+this.zoomInfo.x-w,y=r+this.zoomInfo.y-m,I=g*(n-1);I=Math.floor(I),D<0?D=0:D>I&&(D=I);var E=a?0:Math.ceil(u*d*n);if(I=a?d*n-f:E+(n-1)*f,I=Math.floor(I),y<E?y=E:y>I&&(y=I),a&&(this.viewInfo.scrollLeft=Math.ceil(D/n),this.viewInfo.scrollTop=Math.ceil(y/n)),this.viewInfo.ticking=!0,this.docDom.scrollTo(D,y),this.renderDom.scrollTo(D,y),t)if(this.zoomInfo.x=0,this.zoomInfo.y=0,this.viewInfo.ticking=!1,n>1&&y>=c&&y<=l)this.postSyncDragMessage(D,y-u*d*n);else{if(!a)return!h&&this.postWhiteboardMessage(s.DomEventAction.WbError,s.ZegoWhiteboardError.ZegoWhiteboardViewErrorNoAuthScroll),this.viewInfo.ticking=!0,this.docDom.scrollTo(i,r),this.renderDom.scrollTo(i,r),void(this.viewInfo.ticking=!1);this.updateCurViewMax(y,n),this.onScrollCallback(D,y)}},e.prototype.dragPPT=function(e,t){var o=this.zoomInfo,i=o.tx,r=o.ty,n=o.zoom,s=this.viewInfo,a=s.viewWidth,h=s.viewHeight,c=e instanceof MouseEvent?e:e.changedTouches[0],l=c.clientX,p=c.clientY,g=i+l-this.zoomInfo.x,d=r+p-this.zoomInfo.y,f=a*(1-n);g>0?g=0:g<f&&(g=f),f=h*(1-n),d>0?d=0:d<f&&(d=f),t&&(this.zoomInfo.x=0,this.zoomInfo.y=0,this.postSyncDragMessage(g,d,!t)),this.setDocsViewDomTransform(g,d)},e.prototype.handleSetScaleFactor=function(e,t,o,i){var r=this;this.ppth5Info.notify=i,this.zoomInfo.zoom=e;var n=this.viewInfo,a=n.viewWidth,h=n.viewHeight,c=n.width,l=n.height,p=n.scrollTop,g=n.percent;if(this.setDocsViewDomOverflow(),this.renderMode===s.RenderMode.PDF){var d=this.getDocViewChild();d.style.cssText+="transform:scale("+e+");",(d=this.renderDom.firstChild).style.cssText+="transform:scale("+e+");";var f=t*c*e,u=(o+g)*l*e;i&&(f=a*(e-1)*.5,u=(u=p)*e+h*(e-1)*.5),f=Math.round(f),u=Math.round(u),this.viewInfo.ticking=!0,this.docDom.scrollTo(f,u),this.renderDom.scrollTo(f,u),this.postSyncDragMessage(f,u-g*l*e),this.updateCurViewMax(Math.ceil(g*l*e),e),clearTimeout(this.viewInfo.scrollTimeId),this.viewInfo.scrollTimeId=window.setTimeout((function(){r.viewInfo.ticking=!1}),34)}else{f=Math.round(i?a*(1-e)*.5:-t*c*e),u=Math.round(i?h*(1-e)*.5:-o*l*e);this.setDocsViewDomTransform(f,u),this.postSyncDragMessage(f,u)}this.wbId||(this.zoomInfo.isDrag=e>1,this.docDom.style.cursor=e>1?"move":"auto"),this.renderMode!==s.RenderMode.PDF&&this.renderMode!==s.RenderMode.PPT||this.loadCurrentSheet()},e.prototype.updateCurViewMax=function(e,t){t>1?(this.zoomInfo.dragRectTop=e-2,this.zoomInfo.dragRectBottom=Math.ceil(e+this.viewInfo.viewHeight*(t-1))):(this.zoomInfo.dragRectTop=0,this.zoomInfo.dragRectBottom=0)},e.prototype.drawPDFBlank=function(e,t){var o=this;if(!(this.canvasArray.length<2)){for(var i=t,r=0,n=0;n<i;)n+=this.getCanvasHeight(r++);var s=r>0?r-1:0;for(i+=e,r=0,n=0;n<i;){var c=this.getCanvasHeight(r++);if(n+=c,0===c)break}for(var l=this.viewInfo,p=l.canvasMaxPage,g=l.isParentScale,d=r>0?r-1:0,f=[];s<=d;s++)f.push(s*p+1);if(g)this.execScrollFileAndDraw(f[0],void 0,f);else{f.forEach((function(e){return o.execDraw(e,void 0)}));var u={id:this.id,pages:f};a.Logger.info(h("draw_scrolled"),JSON.stringify(u))}}},e.prototype.firstNeedPlayAnimation=function(){var e=this.viewInfo.firstInfo,t=e.page,o=e.step,i=e.h5Extra;t&&i&&t==this.ppth5Info.page&&o==this.ppth5Info.step&&(this.playAnimation(i),this.viewInfo.firstInfo.page=0,this.viewInfo.firstInfo.step=0)},e.prototype.getAllVirtualInPageRange=function(e,t){var o=this.getFile().page_list,i=[];e<0&&(e=0),t>=o.length&&(t=o.length-1);for(var r=e;r<=t;++r)for(var n=0,s=o[r].virtual_page_list;n<s.length;n++){var a=s[n];i.push(a.virtual_page_number)}return i},e.prototype.startGetImageByVirtualPageList=function(e,t){for(var o=[],i=this.vpageImgCache[this.viewInfo.sheet],r=0;r<e.length;){var n=i&&i[e[r]];n?(o.push(n),e.splice(r,1)):r++}this.getImageByVirtualPageList(o,e,t)},e.prototype.sortVirtualPageListRule=function(e,t){return e.virtual_page_number-t.virtual_page_number},e.prototype.getImageByVirtualPageList=function(e,t,o){var i=this;if(t.length<=0)return e.sort(this.sortVirtualPageListRule),void o(e);this.serviceHandle.registerEventHandler(this.id,s.DocsListener.GetPageImage,(function(r){for(var n=r.virtual_page_number,s=0;s<t.length;++s)if(t[s]==n){t.splice(s,1);break}var a=i.vpageImgCache[i.viewInfo.sheet]||{};a[n]=r,i.vpageImgCache[i.viewInfo.sheet]=a;var h=!1;for(s=0;s<e.length;++s)e[s].virtual_page_number==n&&(e[s]=r,h=!0);h||e.push(r),i.getImageByVirtualPageList(e,t,o)}));var r=this.viewInfo,n=r.sheet,a=r.rate;this.serviceHandle.getPageImage(this.id,{sheet:n,rate:a*s.RENDER_MAX_ZOOM*1.5,virtual_page_number:t[0],virtual_start:this.vpageAspecCache[n].vs-1,res:this.fileInfo})},e.prototype.getFile=function(){return this.fileInfo.file_list[this.viewInfo.sheet]},e.prototype.execGotoPage=function(e,t,o){e!==this.ppth5Info.page?(this.ppth5Info.page=e,this.ppth5Info.step=this.renderMode===s.RenderMode.H5_CUSTOM?t:1,this.gotoPage(o)):t<this.ppth5Info.step?this.previousStep(this.ppth5Info.notify,"execGotoPage("+e+","+t+","+this.ppth5Info.step+")"):t>this.ppth5Info.step?this.nextStep(this.ppth5Info.notify,"execGotoPage("+e+","+t+","+this.ppth5Info.step+")"):t!==this.ppth5Info.step||1===this.ppth5Info.targetPage&&1===this.ppth5Info.targetStep||(this.ppth5Info.targetPage=0,this.ppth5Info.targetStep=0)},e.prototype.runGotoPageQueue=function(e,t,o,i){var r=this;this.ppth5Info.targetPage=e,this.ppth5Info.targetStep=t,this.execGotoPage(e,t,o);var n=this.ppth5Info.loaded?s.SYNC_PPT_TIME:s.SYNC_PPT_INIT_TIME;this.ppth5Info.syncTimer&&clearTimeout(this.ppth5Info.syncTimer),this.ppth5Info.syncTimer=window.setTimeout((function(){return r[i](!0)}),n)},e.prototype.syncWhiteboardPPTH5Queue=function(e,t){var o=this,i=this.ppth5Info,r=i.page,n=i.step,s=i.loaded,c=i.notify;if(e!=r||t!=n){var l={page:e,step:t,notify:c,loaded:s,id:this.id},p=this.serviceHandle.getStore();p.syncPPTH5Queue=p.syncPPTH5Queue&&p.syncPPTH5Queue.length?p.syncPPTH5Queue.filter((function(e){return e.id===o.id})):[];var g=p.syncPPTH5Queue[p.syncPPTH5Queue.length-1];if(!g||g.page===e&&g.step===t)g||(p.syncPPTH5Queue=[l],a.Logger.info(h("h5_wbqueue_init"),JSON.stringify({task:l})),this.runGotoPageQueue(l.page,l.step,l.notify,"execSyncPPTH5Queue"));else{var d={page:r,step:n,task:l,queue:p.syncPPTH5Queue.map((function(e){return e.page+"-"+e.step})).join()};p.syncPPTH5Queue.push(l),a.Logger.info(h("h5_wbqueue_push"),JSON.stringify(d))}}},e.prototype.execSyncPPTH5Queue=function(e){var t=this.serviceHandle.getStore(),o=t.syncPPTH5Queue,i=e&&t.syncQueueRuning;if(i&&this.execQueueTimeout(o),t.syncQueueRuning=!1,o&&o.length){t.syncQueueRuning=!0;var r=o.shift();i&&!o[0]||(r=o[0]),r&&(a.Logger.info(h("h5_wbqueue_pop"),JSON.stringify({timeout:e,task:r,store:t})),this.runGotoPageQueue(r.page,r.step,r.notify,"execSyncPPTH5Queue"))}},e.prototype.execMultiDocsQueue=function(e){var t=this,o=this.serviceHandle.getStore(),i=o.multiDocsQueue;if(e&&o.syncQueueRuning&&this.execQueueTimeout(i),o.syncQueueRuning=!1,i&&i.length){o.syncQueueRuning=!0;var n=[],s=i.shift();n.push(s);for(var c=0;c<i.length;c++){var l=i[c];l&&l.id!==s.id&&l.p!==s.p&&(s=l,n.push(s),i.splice(c,1))}a.Logger.info(h("h5_mdqueue_pop"),JSON.stringify({timeout:e,tasks:n,store:o})),n.forEach((function(e){t.serviceHandle.execViewFuction("runGotoPageQueue",e.id,r(e.args,["execMultiDocsQueue"]))}))}},e.prototype.execQueueTimeout=function(e){if(e&&e.length){for(var t=[],o=0;o<e.length-1;o++)e[o]&&!e[o].loaded&&(t.push(e[o]),e.splice(o,1));var i={id:this.id,loaded:this.ppth5Info.loaded,queue:e,tasks:t};a.Logger.info(h("h5_queue_timeout"),JSON.stringify(i))}this.ppth5Info.loaded=!0,this.ppth5Info.targetPage=0,this.ppth5Info.targetStep=0,this.postStepChangeMessage(),this.postMessage2iframe(s.H5ScriptEvents.HideLoadingStyle)},e.prototype.gotoPage=function(e){this.ppth5Info.notify=e,this.renderMode===s.RenderMode.H5_PPT?(a.Logger.info(h("gotoPage"),JSON.stringify({id:this.id,notify:e,page:this.ppth5Info.page})),this.postMessage2iframe(s.H5ScriptEvents.GotoPage,[this.ppth5Info.page-1,e])):this.renderMode===s.RenderMode.H5_CUSTOM?this.postMessage2iframe(s.H5ScriptEvents.GotoPage,[this.ppth5Info.page,this.ppth5Info.step,e]):this.handleScroll(this.getScrollTopByPage(this.ppth5Info.page))},e.prototype.checkParamsPage=function(e){var t=this.getPageCount();return e<1?e=1:e>t?e=t:e|=0,e},e.prototype.delayDraw=function(e){var t=this;return function(o){t.isAppleDevice()?setTimeout(e.bind(t,o)):e(o)}},e.prototype.isAppleDevice=function(){var e=navigator.userAgent,t=e.includes("Mac"),o=!e.includes("Chrome")&&e.includes("Safari");return this.isTouch?t:o},e.prototype.getCDNHostList=function(){return this.fileInfo.cdn_hosts||[]},e.prototype.docsSnapshot=function(e){var t=e.ctx,o=e.snapshotId;this.renderMode===s.RenderMode.H5_PPT||this.renderMode===s.RenderMode.H5_CUSTOM?this.postMessage2iframe(s.H5ScriptEvents.SnapshotForH5,[o]):this.snapshotForStatic(t)},e.prototype.getH5SnapshotResult=function(e){var t=i(i({},e),{action:s.DomEventAction.H5Snapshot});this.docDom.dispatchEvent(new CustomEvent(s.DomEvent.Docs,{detail:t}))},e.prototype.snapshotForStatic=function(e){var t=this.viewInfo,o=t.width,i=t.height,r=t.viewWidth,n=t.viewHeight,a=t.scrollTop,h=t.sheet,c=Math.min(o,r),l=Math.min(i,n),p=this.getCanvasInds(n,a);e.clearRect(0,0,r,n);for(var g=0,d=0;d<=p[0];)g+=this.getCanvasHeight(d++);var f=(a-g+this.vpageAspecCache[h].h[p[0]])*s.RENDER_MAX_ZOOM,u=c*s.RENDER_MAX_ZOOM,v=l*s.RENDER_MAX_ZOOM;if(e.drawImage(this.canvasArray[p[0]],0,f,u,v,0,0,c,l),2===p.length){var w=g-a,m=(l-w)*s.RENDER_MAX_ZOOM;e.drawImage(this.canvasArray[p[1]],0,0,u,m,0,w,c,l-w)}},e.prototype.getCanvasInds=function(e,t){if(this.canvasArray.length<2)return[0];for(var o=0,i=0;i<t;)i+=this.getCanvasHeight(o++);var r=o>0?o-1:0,n=t+e;for(o=0,i=0;i<n;){var s=this.getCanvasHeight(o++);if(i+=s,0===s)break}var a=o>0?o-1:0;return r===a?[r]:[r,a]},e.prototype.setSheetName=function(e){this.viewInfo.sheetName=e},e.prototype.resetVisibleSize=function(){if(this.docDom&&this.renderMode===s.RenderMode.PDF){var e=document.getElementById(this.parent),t=e.clientWidth,o=e.clientHeight,i="width:"+t+"px;height:"+o+"px;",r=this.docDom.parentElement;this.docDom.style.cssText+=i+"overflow: hidden auto;",this.renderDom.style.cssText+=i+"overflow: hidden auto;",r.style.cssText+=i+"top:"+Math.max(0,(o-this.viewInfo.height)/2)+"px;",this.drawPDFBlank(o,this.viewInfo.scrollTop),this.viewInfo.isParentScale=!0}},e.prototype.addDOMEventListener=function(e,t){this.domEventListeners||(this.domEventListeners={}),this.domEventListeners[e]=t},e.prototype.enableDOMEvent=function(e){var t=this.docDom&&this.docDom.parentElement;t&&this.renderMode===s.RenderMode.H5_PPT&&(t.style.cssText+="pointer-events:"+(e?"initial":"none")+";")},e.prototype.loadFile=function(e,t,o){var i=this;return this.loadFileListener=o,this.serviceHandle.setStore({activitedId:this.id}),this.viewInfo.ticking=!1,this.fileInfo.file_id===e?(setTimeout((function(){i.hideOtherDocsView(),i.loadFileCallback()})),Promise.resolve(this.getLoadFileModelForAPI(this.fileInfo))):(a.Logger.setExtraConfig({fileID:e}),this.serviceHandle.load(this.id,{fileID:e,authKey:t},!0).then((function(e){return i.getLoadFileModelForAPI(e)})))},e.prototype.unloadFile=function(){var e,t,o=null===(e=this.docDom)||void 0===e?void 0:e.parentElement;o&&(null===(t=o.parentElement)||void 0===t||t.removeChild(o),a.Logger.info(h("unloadFile"))),this.serviceHandle.execViewFuction("unloadFile",this.id,[])},e.prototype.getContentSize=function(){return{width:this.viewInfo.width,height:this.viewInfo.height}},e.prototype.getVisibleSize=function(){return{width:this.viewInfo.viewWidth,height:this.viewInfo.viewHeight}},e.prototype.getFileID=function(){return this.fileInfo.file_id},e.prototype.getFileType=function(){return this.fileInfo.file_type},e.prototype.getCurrentPage=function(){return this.ppth5Info.page},e.prototype.getCurrentStep=function(){return this.ppth5Info.step},e.prototype.getPageCount=function(){return this.viewInfo.total},e.prototype.getPPTNotes=function(e){return e=this.checkParamsPage(e),this.fileInfo.notes[e-1]||""},e.prototype.getThumbnailUrlList=function(){return this.fileInfo.thumbnails},e.prototype.getVerticalPercent=function(){return this.viewInfo.percent},e.prototype.scrollTo=function(e,t){this.ppth5Info.notify=void 0===t||!!t;var o=Math.ceil(this.viewInfo.height*e*this.zoomInfo.zoom),i=this.getPageByScrollTop(o);this.ppth5Info.page=i,this.handleScroll(o),-1!==this.viewInfo.firstInfo.scrollTop&&(this.viewInfo.firstInfo.scrollTop=o),a.Logger.info(h("scrollTo"),JSON.stringify({id:this.id,params:e,page:i,top:o}))},e.prototype.flipPage=function(e,t,o){e=this.checkParamsPage(e),t="number"==typeof t?Math.max(1,0|t):1,o=void 0===o||!!o,this.ppth5Info.notify=o;var i=this.renderMode===s.RenderMode.H5_PPT||this.renderMode===s.RenderMode.H5_CUSTOM,r=i&&this.viewInfo.maxSteps[e-1];if(r&&t>r)a.Logger.info(h("flipPage"),JSON.stringify({actionMsg:"error step",params:{page:e,step:t,maxStep:r}}));else if(i&&this.wbId)this.syncWhiteboardPPTH5Queue(e,t);else{i&&(this.ppth5Info.targetPage=e,this.ppth5Info.targetStep=t);var n=this.ppth5Info.loaded,c=this.serviceHandle.getStore();if(i&&(n||!n&&(e>1||t>1))){if(c.multiDocsQueue&&c.syncQueueRuning){for(var l=!0,p=this.id,g=c.multiDocsQueue.length-1;g>=0;g--){var d=c.multiDocsQueue[g];if(d.id==p&&d.args.page==e&&d.args.step==t){l=!1;break}}if(l){var f={p:this.parent,id:this.id,loaded:n,args:[e,t,o]};return c.multiDocsQueue.push(f),void a.Logger.info(h("h5_mdqueue_push"),JSON.stringify({task:f}))}}c.syncQueueRuning=!0,c.multiDocsQueue=c.multiDocsQueue||[]}c.multiDocsQueue?this.runGotoPageQueue(e,t,o,"execMultiDocsQueue"):(-1!==this.viewInfo.firstInfo.scrollTop&&(this.viewInfo.firstInfo.scrollTop=this.getScrollTopByPage(e)),this.execGotoPage(e,t,o)),a.Logger.info(h("flipPage"),JSON.stringify({id:this.id,params:{page:e,step:t}}))}},e.prototype.previousStep=function(e,t){var o=this.ppth5Info,i=o.page,r=o.step;1===i&&1===r||(e=void 0===e||!!e,this.zoomInfo.enableScroll||!e||1!==r?(this.ppth5Info.notify=e,this.postMessage2iframe(s.H5ScriptEvents.PreviousStep,[e]),e&&this.postWhiteboardMessage(s.DomEventAction.Step,""),a.Logger.info(h("previousStep"),JSON.stringify({id:this.id,notify:e,action:t}))):!this.zoomInfo.remoteScroll&&this.postWhiteboardMessage(s.DomEventAction.WbError,s.ZegoWhiteboardError.ZegoWhiteboardViewErrorNoAuthScroll))},e.prototype.nextStep=function(e,t){var o=this.ppth5Info,i=o.page,r=o.step;e=void 0===e||!!e,this.zoomInfo.enableScroll||!e||r!==this.viewInfo.maxSteps[i-1]?(this.ppth5Info.notify=e,this.postMessage2iframe(s.H5ScriptEvents.NextStep,[e]),e&&this.postWhiteboardMessage(s.DomEventAction.Step,""),a.Logger.info(h("nextStep"),JSON.stringify({id:this.id,notify:e,action:t}))):!this.zoomInfo.remoteScroll&&this.postWhiteboardMessage(s.DomEventAction.WbError,s.ZegoWhiteboardError.ZegoWhiteboardViewErrorNoAuthScroll)},e.prototype.switchSheet=function(e){this.getFileType()===s.ZegoDocsViewFileType.ZegoDocsViewFileTypeELS&&this.viewInfo.sheet!==e&&e>=0&&e<this.fileInfo.file_list.length&&(this.viewInfo.sheet=e,this.vpageDrawImgCache={},this.loadCurrentSheet(!1,!0),a.Logger.info(h("switchSheet"),JSON.stringify({id:this.id,params:e})))},e.prototype.setScaleFactor=function(e,t,o){var i=e;(!i||i<1)&&(i=1),this.zoomInfo.zoom!==i&&(this.renderMode!==s.RenderMode.H5_PPT&&this.renderMode!==s.RenderMode.H5_CUSTOM||this.iframeDom)&&(this.renderMode!==s.RenderMode.PDF&&this.renderMode!==s.RenderMode.PPT||this.canvasArray[0])&&(a.Logger.info(h("setScaleFactor"),JSON.stringify({zoom:i,x:t,y:o})),this.handleSetScaleFactor(i,t||0,o||0,!0))},e.prototype.getScaleFactor=function(){return{scaleFactor:this.zoomInfo.zoom,scaleOffsetX:0,scaleOffsetY:0}},e.prototype.playAnimation=function(e){this.postMessage2iframe(s.H5ScriptEvents.TriggerElementsClick,[e]),a.Logger.info(h("playAnimation"),e)},e.prototype.stopPlay=function(e){this.postMessage2iframe(s.H5ScriptEvents.StopPlay,[e]),a.Logger.info(h("stopPlay"),e)},e.prototype.setVolume=function(e){this.postMessage2iframe(s.H5ScriptEvents.SetVolume,[e]),a.Logger.info(h("setVolume"),e)},e.prototype.reloadView=function(){if(this.canReloadView()){var e=this.viewInfo.scrollLeft/this.viewInfo.width,t=this.viewInfo.scrollTop/this.viewInfo.height,o=this.zoomInfo.tx/this.viewInfo.viewWidth,i=this.zoomInfo.ty/this.viewInfo.viewHeight;this.tranlateFileAspec(this.fileInfo);var r=this.getFile();if(this.viewInfo.width=r.max_width,this.viewInfo.height=r.total_height,this.viewInfo.total=r.page_count,this.viewInfo.rate=r.rate,this.ppth5Info.notify=!1,this.renderMode===s.RenderMode.H5_PPT||this.renderMode===s.RenderMode.H5_CUSTOM){var n=this.vpageAspecCache[0][1],a=n.x,h=n.y,c=n.w,l=n.h;this.iframeDom.width=c,this.iframeDom.height=l,this.postSyncDragMessage(o*c|0,i*l|0),this.updateDocsViewLayout(a,h,c,l),this.setDocsViewDomOverflow(),this.getDocViewChild().style.cssText+="width:"+this.viewInfo.width+"px;height:"+this.viewInfo.height+"px;",this.reloadViewCallback();var p=this.getFile().page_list[0].width;this.ppth5Info.scale=Number((c/p).toFixed(4)),this.renderMode===s.RenderMode.H5_PPT&&this.postMessage2iframe(s.H5ScriptEvents.SetCustomizedConfig,[s.H5ScriptConfig.Scale,this.ppth5Info.scale])}else{if(this.canvasArray=[],this.vpageDrawImgCache={},this.docDom.innerHTML="",this.renderDom.innerHTML="",this.renderMode===s.RenderMode.PDF)this.viewInfo.ticking=!0,this.viewInfo.scrollLeft=e*this.viewInfo.width,this.viewInfo.scrollTop=t*this.viewInfo.height;else{var g=this.vpageAspecCache[0][1];c=g.w,l=g.h;this.postSyncDragMessage(o*c|0,i*l|0)}this.execScrollFileAndDraw(this.ppth5Info.page,this.reloadViewCallback)}}},e}();t.ZegoDocsViewImpl=c},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=new Image;t.IMG_ERROR=i,i.src="data:image/png;base64,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";t.IMG_LOADING='<path d="M834.7648 736.3584a5.632 5.632 0 1 0 11.264 0 5.632 5.632 0 0 0-11.264 0z m-124.16 128.1024a11.1616 11.1616 0 1 0 22.3744 0 11.1616 11.1616 0 0 0-22.3744 0z m-167.3216 65.8944a16.7936 16.7936 0 1 0 33.6384 0 16.7936 16.7936 0 0 0-33.6384 0zM363.1616 921.6a22.3744 22.3744 0 1 0 44.7488 0 22.3744 22.3744 0 0 0-44.7488 0z m-159.744-82.0224a28.0064 28.0064 0 1 0 55.9616 0 28.0064 28.0064 0 0 0-56.0128 0zM92.672 700.16a33.6384 33.6384 0 1 0 67.2256 0 33.6384 33.6384 0 0 0-67.2256 0zM51.2 528.9984a39.168 39.168 0 1 0 78.336 0 39.168 39.168 0 0 0-78.336 0z m34.1504-170.0864a44.8 44.8 0 1 0 89.6 0 44.8 44.8 0 0 0-89.6 0zM187.904 221.7984a50.432 50.432 0 1 0 100.864 0 50.432 50.432 0 0 0-100.864 0zM338.432 143.36a55.9616 55.9616 0 1 0 111.9232 0 55.9616 55.9616 0 0 0-111.9744 0z m169.0112-4.9152a61.5936 61.5936 0 1 0 123.2384 0 61.5936 61.5936 0 0 0-123.2384 0z m154.7776 69.632a67.1744 67.1744 0 1 0 134.3488 0 67.1744 67.1744 0 0 0-134.3488 0z m110.0288 130.816a72.8064 72.8064 0 1 0 145.5616 0 72.8064 72.8064 0 0 0-145.5616 0z m43.7248 169.472a78.3872 78.3872 0 1 0 156.8256 0 78.3872 78.3872 0 0 0-156.8256 0z" fill="#cdcdcd"></path>'},function(e,t,o){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0});var r=o(10),n=((i={30001:"请求过于频繁",60011:"token无效",60012:"token已过期",60013:"文档转换请求已处理",60014:"不存在的任务ID"})[r.ZegoDocsViewError.ZegoDocsViewSuccess]="执行成功",i[r.ZegoDocsViewError.ZegoDocsViewErrorInternal]="内部错误",i[r.ZegoDocsViewError.ZegoDocsViewErrorParamInvalid]="参数错误",i[r.ZegoDocsViewError.ZegoDocsViewErrorNetworkTimeout]="网络超时",i[r.ZegoDocsViewError.ZegoDocsViewErrorFileNotExist]="找不到对应的本地文件",i[r.ZegoDocsViewError.ZegoDocsViewErrorUploadFailed]="上传失败",i[r.ZegoDocsViewError.ZegoDocsViewErrorUnsupportRenderType]="不支持渲染模式",i[r.ZegoDocsViewError.ZegoDocsViewErrorFileEncrypt]="文件被加密",i[r.ZegoDocsViewError.ZegoDocsViewErrorFileSizeLimit]="文件内容过大",i[r.ZegoDocsViewError.ZegoDocsViewErrorFileSheetLimit]="文件页数过多",i[r.ZegoDocsViewError.ZegoDocsViewErrorConvertFail]="格式转换失败",i[r.ZegoDocsViewError.ZegoDocsViewErrorConvertCancel]="格式转换被取消",i[r.ZegoDocsViewError.ZegoDocsViewErrorFileContentEmpty]="文件内容为空",i[r.ZegoDocsViewError.ZegoDocsViewErrorFileReadOnly]="文件为只读模式",i[r.ZegoDocsViewError.ZegoDocsViewErrorConvertElementNotSupported]="源文件中存在不支持转码的元素",i[r.ZegoDocsViewError.ZegoDocsViewErrorConvertFileTypeInvalid]="文件后缀名不匹配",i[r.ZegoDocsViewError.ZegoDocsViewErrorAuthParamInvalid]="认证参数错误",i[r.ZegoDocsViewError.ZegoDocsViewErrorFilePathNotAccess]="路径权限不足",i[r.ZegoDocsViewError.ZegoDocsViewErrorInitFailed]="初始化失败",i[r.ZegoDocsViewError.ZegoDocsViewErrorSizeInvalid]="无法获取当前 view 宽高",i[r.ZegoDocsViewError.ZegoDocsViewErrorFreeSpaceLimit]="本地空间不足",i[r.ZegoDocsViewError.ZegoDocsViewErrorUploadNotSupported]="不支持文件上传功能",i[r.ZegoDocsViewError.ZegoDocsViewErrorUploadDuplicated]="正在上传相同文件",i[r.ZegoDocsViewError.ZegoDocsViewErrorEmptyDomain]="空域名",i[r.ZegoDocsViewError.ZegoDocsViewErrorHaveInit]="已初始化",i[r.ZegoDocsViewError.ZegoDocsViewErrorServerFileNotExist]="找不到对应的转码后文件",i[r.ZegoDocsViewError.ZegoDocsViewErrorCacheNotSupported]="当前 AppID 不支持动态 PPT 预加载",i[r.ZegoDocsViewError.ZegoDocsViewErrorCacheFailed]="预加载失败",i[r.ZegoDocsViewError.ZegoDocsViewErrorZipFileInvalid]="无效的 ZIP 文件",i[r.ZegoDocsViewError.ZegoDocsViewErrorH5FileInvalid]="无效的 H5 文件，不符合 ZEGO 定义的 H5 文件规范",i),s={4:r.ZegoDocsViewError.ZegoDocsViewErrorParamInvalid,32:r.ZegoDocsViewError.ZegoDocsViewErrorConvertFail,64:r.ZegoDocsViewError.ZegoDocsViewErrorConvertCancel,128:r.ZegoDocsViewError.ZegoDocsViewErrorFileEncrypt,256:r.ZegoDocsViewError.ZegoDocsViewErrorFileSizeLimit,512:r.ZegoDocsViewError.ZegoDocsViewErrorFileSheetLimit,1024:r.ZegoDocsViewError.ZegoDocsViewErrorFileContentEmpty,8192:r.ZegoDocsViewError.ZegoDocsViewErrorFileReadOnly,32768:r.ZegoDocsViewError.ZegoDocsViewErrorConvertElementNotSupported,32769:r.ZegoDocsViewError.ZegoDocsViewErrorConvertFileTypeInvalid,60002:r.ZegoDocsViewError.ZegoDocsViewErrorFileNotExist,60011:r.ZegoDocsViewError.ZegoDocsViewErrorAuthParamInvalid,60013:r.ZegoDocsViewError.ZegoDocsViewErrorConvertCancel,60015:r.ZegoDocsViewError.ZegoDocsViewErrorUnsupportRenderType,60016:r.ZegoDocsViewError.ZegoDocsViewErrorFileSizeLimit,60018:r.ZegoDocsViewError.ZegoDocsViewErrorServerFileNotExist,60021:r.ZegoDocsViewError.ZegoDocsViewErrorUnsupportRenderType,60036:r.ZegoDocsViewError.ZegoDocsViewErrorZipFileInvalid,60037:r.ZegoDocsViewError.ZegoDocsViewErrorFileEncrypt,60038:r.ZegoDocsViewError.ZegoDocsViewErrorH5FileInvalid,"-102":r.ZegoDocsViewError.ZegoDocsViewErrorNetworkTimeout,"-105":r.ZegoDocsViewError.ZegoDocsViewErrorFileNotExist,"-108":r.ZegoDocsViewError.ZegoDocsViewErrorUnsupportRenderType,"-109":r.ZegoDocsViewError.ZegoDocsViewErrorUploadFailed,"-110":r.ZegoDocsViewError.ZegoDocsViewErrorFilePathNotAccess,"-114":r.ZegoDocsViewError.ZegoDocsViewErrorCacheFailed,"-115":r.ZegoDocsViewError.ZegoDocsViewErrorFreeSpaceLimit,"-116":r.ZegoDocsViewError.ZegoDocsViewErrorInitFailed,"-117":r.ZegoDocsViewError.ZegoDocsViewErrorFileSizeLimit,"-118":r.ZegoDocsViewError.ZegoDocsViewErrorUploadNotSupported,"-119":r.ZegoDocsViewError.ZegoDocsViewErrorUploadDuplicated,"-120":r.ZegoDocsViewError.ZegoDocsViewErrorUnsupportRenderType,"-121":r.ZegoDocsViewError.ZegoDocsViewErrorEmptyDomain,"-123":r.ZegoDocsViewError.ZegoDocsViewErrorFileContentEmpty,"-124":r.ZegoDocsViewError.ZegoDocsViewErrorFilePathNotAccess,"-125":r.ZegoDocsViewError.ZegoDocsViewErrorCacheNotSupported,"-126":r.ZegoDocsViewError.ZegoDocsViewErrorFileEncrypt,"-127":r.ZegoDocsViewError.ZegoDocsViewErrorZipFileInvalid,"-128":r.ZegoDocsViewError.ZegoDocsViewErrorFileEncrypt,"-129":r.ZegoDocsViewError.ZegoDocsViewErrorH5FileInvalid,"-130":r.ZegoDocsViewError.ZegoDocsViewErrorConvertElementNotSupported,"-131":r.ZegoDocsViewError.ZegoDocsViewErrorConvertFileTypeInvalid,"-132":r.ZegoDocsViewError.ZegoDocsViewErrorConvertFileTypeInvalid,"-999998":r.ZegoDocsViewError.ZegoDocsViewErrorSizeInvalid,"-999999":r.ZegoDocsViewError.ZegoDocsViewErrorParamInvalid};t.transError=function(e,t){return{code:e=s[e]||e,message:t=n[e]||t||n[r.ZegoDocsViewError.ZegoDocsViewErrorInternal]}},function(e){e[e.ZegoWhiteboardViewErrorNoAuthScroll=3050002]="ZegoWhiteboardViewErrorNoAuthScroll"}(t.ZegoWhiteboardError||(t.ZegoWhiteboardError={}))},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o(7),o(17);var i=o(6),r=function(){function e(){var e,t;this.isElectron=!1,this.store=((e={})[i.ZegoConfigKey.PptStepMode]=1,e[i.ZegoConfigKey.DisableH5ImageDrag]=!1,e[i.ZegoConfigKey.UnloadVideoSrc]=!1,e.multiDocsQueue=null,e.syncPPTH5Queue=null,e.syncQueueRuning=!1,e.activitedId="",e),this.customListeners=((t={})[i.ZegoEventType.Error]=[],t[i.ZegoEventType.LoadFile]=[],t[i.ZegoEventType.Upload]=[],t[i.ZegoEventType.Scroll]=[],t[i.ZegoEventType.StepChange]=[],t[i.ZegoEventType.PlayAnimation]=[],t)}return e.prototype.setStore=function(e){return Object.assign(this.store,e),!0},e.prototype.getStore=function(){return this.store},e.prototype.addEventListener=function(e,t){return!!this.customListeners[e]&&("function"==typeof t&&(-1==this.customListeners[e].indexOf(t)&&this.customListeners[e].push(t),!0))},e.prototype.removeEventListener=function(e,t){if(!this.customListeners[e])return!1;var o=this.customListeners[e];return t?o.splice(o.indexOf(t),1):this.customListeners[e]=[],!0},e.prototype.triggerEventListener=function(e,t){var o=this.customListeners[e];o&&o.forEach((function(e){return e(t)}))},e}();t.ZegoDocsViewServiceBase=r},function(e,t,o){var i=o(8),r=o(18);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var n={insert:"head",singleton:!1};i(r,n);e.exports=r.locals||{}},function(e,t,o){(t=o(9)(!1)).push([e.i,"[id^='zego-docsview-zoom'],\n[id^='zego-docsview-render'],\n[id^='zego-docsview-render'] > div,\n[id^='zego-docsview-con'],\n[id^='zego-docsview-con'] > div {\n  position: absolute;\n  left: 0;\n  top: 0;\n}\n\n/* [id^='zego-docsview-con'], */\n[id^='zego-docsview-con'] > div,\n[id^='zego-docsview-render'] > div,\n[id^='zego-docsview-iframe'] {\n  transform-origin: 0 0;\n}\n\n[id^='zego-docsview-render'] {\n  text-align: initial;\n}\n\n[id^='zego-docsview-render'] iframe {\n  border: none;\n}\n[id^='zego-docsview-render'] canvas {\n  display: block;\n  transform-origin: 0 0;\n}\n\n[id^='zego-docsview-zoom'] svg.loading {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  margin: -24px;\n  display: none;\n  animation: loading 2s infinite linear;\n  -webkit-animation: loading 2s infinite linear;\n  -moz-animation: loading 2s infinite linear;\n  -o-animation: loading 2s infinite linear;\n}\n@keyframes loading {\n  from {\n    transform: rotate(0deg);\n    -ms-transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n    -ms-transform: rotate(360deg);\n  }\n}\n@-webkit-keyframes loading {\n  from {\n    -webkit-transform: rotate(0deg);\n  }\n  to {\n    -webkit-transform: rotate(360deg);\n  }\n}\n@-moz-keyframes loading {\n  from {\n    -moz-transform: rotate(0deg);\n  }\n  to {\n    -moz-transform: rotate(360deg);\n  }\n}\n@-o-keyframes loading {\n  from {\n    -o-transform: rotate(0deg);\n  }\n  to {\n    -o-transform: rotate(360deg);\n  }\n}\n",""]),e.exports=t},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPositiveNumber=function(e){return e&&!isNaN(e)&&/^[1-9]\d*$/.test(String(e))}}]));